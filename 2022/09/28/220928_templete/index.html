<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="John Doe">







<title>板子备忘 | rainman 小站</title>



    <link rel="icon" href="/favicon.jpg">



<style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Sans+SC:wght@300;400;500;700&family=Roboto+Mono&display=swap');
</style>



    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    




    <!-- scripts list from _config.yml -->
    
    <script src="/js/menu.js"></script>
    




    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>







  <meta name="generator" content="Hexo 7.1.1"><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head>
  <body>
    <div class="mask-border">
    </div>

    <div class="wrapper">

      <div class="header">
  <div class="flex-container">
    <div class="header-inner">
      <div class="site-brand-container">
        <a href="/">
          
            回到主页
          
        </a>
      </div>
      <div id="menu-btn" class="menu-btn" onclick="toggleMenu()">
        Menu
      </div>
      <nav class="site-nav">
        <ul class="menu-list">
          
            
              <li class="menu-item">
                <a href="/friends/">友链</a>
              </li> 
                   
          
            
              <li class="menu-item">
                <a href="/archives/">归档</a>
              </li> 
                   
          
          
        </ul>
      </nav>
    </div>
  </div>
</div>


      <div class="main">
        <div class="flex-container">
          <article id="post">

  
    <div class="post-head">
    <div class="post-info">
        <div class="tag-list">
            
                
                    <span class="post-tag">
                        <a href="/tags/tarjan/">
                            tarjan
                        </a>
                    </span>    
                
                    <span class="post-tag">
                        <a href="/tags/%E5%9F%83%E6%B0%8F%E7%AD%9B/">
                            埃氏筛
                        </a>
                    </span>    
                
                    <span class="post-tag">
                        <a href="/tags/KMP/">
                            KMP
                        </a>
                    </span>    
                
                    <span class="post-tag">
                        <a href="/tags/%E5%B9%B6%E6%9F%A5%E9%9B%86/">
                            并查集
                        </a>
                    </span>    
                
                    <span class="post-tag">
                        <a href="/tags/%E8%87%AA%E9%80%82%E5%BA%94%E8%BE%9B%E6%99%AE%E6%A3%AE/">
                            自适应辛普森
                        </a>
                    </span>    
                
                    <span class="post-tag">
                        <a href="/tags/Huffman%E6%A0%91/">
                            Huffman树
                        </a>
                    </span>    
                
                    <span class="post-tag">
                        <a href="/tags/%E6%8B%93%E6%89%91%E6%8E%92%E5%BA%8F/">
                            拓扑排序
                        </a>
                    </span>    
                
                    <span class="post-tag">
                        <a href="/tags/kruscal/">
                            kruscal
                        </a>
                    </span>    
                
                    <span class="post-tag">
                        <a href="/tags/spfa/">
                            spfa
                        </a>
                    </span>    
                
                    <span class="post-tag">
                        <a href="/tags/dijkstra/">
                            dijkstra
                        </a>
                    </span>    
                
                    <span class="post-tag">
                        <a href="/tags/%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/">
                            树状数组
                        </a>
                    </span>    
                
                    <span class="post-tag">
                        <a href="/tags/lca/">
                            lca
                        </a>
                    </span>    
                
                    <span class="post-tag">
                        <a href="/tags/%E5%89%B2%E8%BE%B9/">
                            割边
                        </a>
                    </span>    
                
                    <span class="post-tag">
                        <a href="/tags/%E5%89%B2%E7%82%B9/">
                            割点
                        </a>
                    </span>    
                
                    <span class="post-tag">
                        <a href="/tags/%E9%AB%98%E7%B2%BE%E5%BA%A6/">
                            高精度
                        </a>
                    </span>    
                
                    <span class="post-tag">
                        <a href="/tags/%E4%BA%8C%E5%88%86%E5%9B%BE/">
                            二分图
                        </a>
                    </span>    
                
                    <span class="post-tag">
                        <a href="/tags/Trie/">
                            Trie
                        </a>
                    </span>    
                           
            
        </div>
        <div class="post-title">
            
            
                板子备忘
            
            
        </div>
        <span class="post-date">
            Sep 28, 2022
        </span>
    </div>
    <div class="post-img">
        
            <div class="h-line-primary"></div>
              
    </div>
</div>
    <div class="post-content">
    <p>以前用过的算法模板。</p>
<h2 id="线性筛素数"><a href="#线性筛素数" class="headerlink" title="线性筛素数"></a>线性筛素数</h2><p>给定一个范围N，你需要处理M个某数字是否为质数的询问（每个数字均在范围1-N内）</p>
<p>在没有读入优化的情况下，这份代码提交到洛谷上速度尚可。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">10000100</span>;</span><br><span class="line"><span class="type">bool</span> composite[MAXN];</span><br><span class="line"><span class="type">int</span> prime[MAXN],tail;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_prime</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    composite[<span class="number">0</span>]=<span class="literal">true</span>;</span><br><span class="line">    composite[<span class="number">1</span>]=<span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;i++)</span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">if</span>(!composite[i])prime[tail++]=i;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;tail&amp;&amp;i*prime[j]&lt;=n;j++)</span><br><span class="line">        {</span><br><span class="line">            composite[i*prime[j]]=<span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span>(!(i%prime[j]))<span class="keyword">break</span>;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="type">int</span> n,t,temp;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;t);</span><br><span class="line">    <span class="built_in">get_prime</span>(n);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=t;i++){</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;temp);</span><br><span class="line">        <span class="keyword">if</span>(composite[temp])<span class="built_in">puts</span>(<span class="string">"No"</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"Yes"</span>);</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h2 id="KMP字符串匹配"><a href="#KMP字符串匹配" class="headerlink" title="KMP字符串匹配"></a>KMP字符串匹配</h2><blockquote>
<p>KMP：一个人能走的多远不在于他在顺境时能走的多快，而在于他在逆境时多久能找到曾经的自己。</p>
</blockquote>
<p>对着ryf的博客思路自己写的代码实现，直观但是效率低（会超时）：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> tsize, ssize;</span><br><span class="line">std::vector&lt;<span class="type">int</span>&gt; mynext;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">getNext</span><span class="params">(std::string &amp;t)</span></span>{</span><br><span class="line">    mynext.<span class="built_in">resize</span>(tsize);</span><br><span class="line">    mynext[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;tsize; i++){</span><br><span class="line">        <span class="type">int</span> k=mynext[i<span class="number">-1</span>];</span><br><span class="line">        <span class="keyword">while</span>((t[i] != t[k]) &amp;&amp; (k!=<span class="number">0</span>))k=mynext[k<span class="number">-1</span>];</span><br><span class="line">        <span class="keyword">if</span>(t[i] == t[k])mynext[i]=k+<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> mynext[i]=<span class="number">0</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">output</span><span class="params">(<span class="type">int</span> i)</span></span>{</span><br><span class="line">    std::cout&lt;&lt;i+<span class="number">1</span>&lt;&lt;<span class="string">"\n"</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">kmp</span><span class="params">(std::string &amp;s, std::string &amp;t, <span class="type">int</span> startpos)</span></span>{</span><br><span class="line">    <span class="type">int</span> i = startpos, j = <span class="number">0</span>;</span><br><span class="line">    ssize = s.<span class="built_in">size</span>(), tsize = t.<span class="built_in">size</span>();</span><br><span class="line">    <span class="built_in">getNext</span>(t);</span><br><span class="line">    <span class="keyword">while</span>(s[i]!=t[<span class="number">0</span>]){i++;}</span><br><span class="line">    <span class="type">int</span> icopy = i;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(i+tsize&lt;=ssize){</span><br><span class="line">        <span class="keyword">while</span>(s[i]!=t[<span class="number">0</span>] &amp;&amp; i+tsize&lt;ssize){i++; icopy=i;}</span><br><span class="line">        <span class="keyword">if</span>(s[icopy]==t[j]){</span><br><span class="line">            icopy++, j++;</span><br><span class="line">            <span class="keyword">if</span>(j==tsize){</span><br><span class="line">                <span class="built_in">output</span>(i);</span><br><span class="line">                i += j-mynext[j<span class="number">-1</span>];</span><br><span class="line">                icopy = i; j = <span class="number">0</span>;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">else</span>{</span><br><span class="line">            <span class="keyword">if</span>(i+tsize&gt;=ssize)<span class="keyword">return</span>;</span><br><span class="line">            i += j-mynext[j<span class="number">-1</span>];</span><br><span class="line">            icopy = i; j = <span class="number">0</span>;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">    std::string s, t;</span><br><span class="line">    std::cin&gt;&gt;s&gt;&gt;t;</span><br><span class="line">    <span class="built_in">kmp</span>(s, t, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> i = mynext.<span class="built_in">begin</span>(); i != mynext.<span class="built_in">end</span>(); i++){</span><br><span class="line">        std::cout&lt;&lt;*i&lt;&lt;<span class="string">" "</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>提交入口： <a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P3375">https://www.luogu.com.cn/problem/P3375</a></p>
<p><img src="https://bu.dusays.com/2023/01/21/63cb64be3a38a.gif" alt="9-0.gif"></p>
<p>根据<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1PD4y1o7nd">教学视频</a>改进的可用版本：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXL = <span class="number">1e6</span>+<span class="number">10</span>;</span><br><span class="line"><span class="type">char</span> s[MAXL], t[MAXL];</span><br><span class="line"><span class="type">int</span> mynext[MAXL], ssize, tsize;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">output</span><span class="params">(<span class="type">int</span> i)</span></span>{</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,i+<span class="number">1</span>);</span><br><span class="line">    <span class="comment">//题目要求下标从1开始</span></span><br><span class="line">    <span class="comment">//仅在输出时作相应处理</span></span><br><span class="line">}</span><br><span class="line"><span class="comment">/*   需要其他形式的KMP可以由以下代码改：</span></span><br><span class="line"><span class="comment">class Solution {</span></span><br><span class="line"><span class="comment">public:</span></span><br><span class="line"><span class="comment">    void getNext(int* next, const string&amp; s) {</span></span><br><span class="line"><span class="comment">        int j = 0;</span></span><br><span class="line"><span class="comment">        next[0] = 0;</span></span><br><span class="line"><span class="comment">        for(int i = 1; i &lt; s.size(); i++) {</span></span><br><span class="line"><span class="comment">            while (j &gt; 0 &amp;&amp; s[i] != s[j]) {</span></span><br><span class="line"><span class="comment">                j = next[j - 1];</span></span><br><span class="line"><span class="comment">            }</span></span><br><span class="line"><span class="comment">            if (s[i] == s[j]) {</span></span><br><span class="line"><span class="comment">                j++;</span></span><br><span class="line"><span class="comment">            }</span></span><br><span class="line"><span class="comment">            next[i] = j;</span></span><br><span class="line"><span class="comment">        }</span></span><br><span class="line"><span class="comment">    }</span></span><br><span class="line"><span class="comment">    int strStr(string haystack, string needle) {</span></span><br><span class="line"><span class="comment">        if (needle.size() == 0) {</span></span><br><span class="line"><span class="comment">            return 0;</span></span><br><span class="line"><span class="comment">        }</span></span><br><span class="line"><span class="comment">        int next[needle.size()];</span></span><br><span class="line"><span class="comment">        getNext(next, needle);</span></span><br><span class="line"><span class="comment">        int j = 0;</span></span><br><span class="line"><span class="comment">        for (int i = 0; i &lt; haystack.size(); i++) {</span></span><br><span class="line"><span class="comment">            while(j &gt; 0 &amp;&amp; haystack[i] != needle[j]) {</span></span><br><span class="line"><span class="comment">                j = next[j - 1];</span></span><br><span class="line"><span class="comment">            }</span></span><br><span class="line"><span class="comment">            if (haystack[i] == needle[j]) {</span></span><br><span class="line"><span class="comment">                j++;</span></span><br><span class="line"><span class="comment">            }</span></span><br><span class="line"><span class="comment">            if (j == needle.size() ) {</span></span><br><span class="line"><span class="comment">                return (i - needle.size() + 1);</span></span><br><span class="line"><span class="comment">            }</span></span><br><span class="line"><span class="comment">        }</span></span><br><span class="line"><span class="comment">        return -1;</span></span><br><span class="line"><span class="comment">    }</span></span><br><span class="line"><span class="comment">};</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">getNext</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="type">int</span> j = <span class="number">0</span>;</span><br><span class="line">    mynext[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;tsize; i++){</span><br><span class="line">        <span class="keyword">while</span>(j&gt;<span class="number">0</span> &amp;&amp; t[i]!=t[j]) j=mynext[j<span class="number">-1</span>];</span><br><span class="line">        <span class="keyword">if</span>(t[i]==t[j]) j++;</span><br><span class="line">        mynext[i] = j;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">kmpfind</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="keyword">if</span>(!tsize){<span class="built_in">printf</span>(<span class="string">"寻找内容为空串！\n"</span>); <span class="keyword">return</span>;}</span><br><span class="line">    <span class="built_in">getNext</span>();</span><br><span class="line">    <span class="type">int</span> j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; ssize; i++) {</span><br><span class="line">        <span class="keyword">while</span>(j &gt; <span class="number">0</span> &amp;&amp; s[i] != t[j]) {</span><br><span class="line">            j = mynext[j<span class="number">-1</span>];</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span>(s[i]==t[j]) j++;</span><br><span class="line">        <span class="keyword">if</span> (j==tsize) {</span><br><span class="line">            <span class="built_in">output</span>(i-tsize+<span class="number">1</span>);</span><br><span class="line">            j = mynext[j<span class="number">-1</span>];</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s%s"</span>,s,t);</span><br><span class="line">    ssize=<span class="built_in">strlen</span>(s); tsize=<span class="built_in">strlen</span>(t);</span><br><span class="line">    <span class="comment">//本程序下标都是从0开始</span></span><br><span class="line">    <span class="built_in">kmpfind</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i&lt;tsize; i++){</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>,mynext[i]);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h2 id="并查集"><a href="#并查集" class="headerlink" title="并查集"></a>并查集</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=<span class="number">10010</span>;</span><br><span class="line"><span class="type">int</span> uset[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">makeset</span><span class="params">(<span class="type">int</span> size)</span></span>{</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;size;i++)uset[i]=i;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span>{</span><br><span class="line">    <span class="keyword">if</span>(x!=uset[x])uset[x]=<span class="built_in">find</span>(uset[x]);</span><br><span class="line">    <span class="keyword">return</span> uset[x];</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">unionset</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>{</span><br><span class="line">    x=<span class="built_in">find</span>(x);</span><br><span class="line">    y=<span class="built_in">find</span>(y);</span><br><span class="line">    <span class="keyword">if</span>(x==y)<span class="keyword">return</span>;</span><br><span class="line">    uset[x]=y;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="type">int</span> n,m; cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">    <span class="built_in">makeset</span>(n+<span class="number">1</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="type">int</span> z,x,y;</span><br><span class="line">    <span class="keyword">while</span>(m--)</span><br><span class="line">    {</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;z,&amp;x,&amp;y);</span><br><span class="line">        <span class="keyword">if</span>(z==<span class="number">1</span>)<span class="built_in">unionset</span>(x,y);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(z==<span class="number">2</span>){</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">find</span>(x)==<span class="built_in">find</span>(y))</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"Y\n"</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"N\n"</span>);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h2 id="自适应辛普森"><a href="#自适应辛普森" class="headerlink" title="自适应辛普森"></a>自适应辛普森</h2><p>题面：<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P4525">https://www.luogu.com.cn/problem/P4525</a></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">double</span> a,b,c,d,L,R;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">double</span> <span class="title">f</span><span class="params">(<span class="type">double</span> x)</span></span>{</span><br><span class="line">    <span class="keyword">return</span> (c*x+d)/(a*x+b);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">double</span> <span class="title">simpson</span><span class="params">(<span class="type">double</span> l, <span class="type">double</span> r)</span></span>{</span><br><span class="line">    <span class="type">double</span> mid = l+(r-l)/<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">f</span>(l)+<span class="number">4</span>*<span class="built_in">f</span>(mid)+<span class="built_in">f</span>(r))/<span class="number">6.0</span>*(r-l);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">asr</span><span class="params">(<span class="type">double</span> l, <span class="type">double</span> r, <span class="type">double</span> eps, <span class="type">double</span> S, <span class="type">int</span> cnt)</span></span>{</span><br><span class="line">    <span class="type">double</span> mid = l+(r-l)/<span class="number">2</span>;</span><br><span class="line">    <span class="type">double</span> s1 = <span class="built_in">simpson</span>(l, mid), s2 = <span class="built_in">simpson</span>(mid, r);</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">fabs</span>(s1+s2-S)&lt;=<span class="number">15</span>*eps &amp;&amp; cnt&lt;=<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> s1+s2+(s1+s2-S)/<span class="number">15.0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">asr</span>(l, mid, eps/<span class="number">2</span>, s1, cnt<span class="number">-1</span>) + <span class="built_in">asr</span>(mid, r, eps/<span class="number">2</span>, s2, cnt<span class="number">-1</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">calc</span><span class="params">(<span class="type">double</span> l, <span class="type">double</span> r, <span class="type">double</span> eps)</span></span>{</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">asr</span>(l, r, eps, <span class="built_in">simpson</span>(l,r), <span class="number">12</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lf%lf%lf%lf%lf%lf"</span>,&amp;a,&amp;b,&amp;c,&amp;d,&amp;L,&amp;R);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%.6lf"</span>,<span class="built_in">calc</span>(L,R,<span class="number">1e-6</span>));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h2 id="Huffman树"><a href="#Huffman树" class="headerlink" title="Huffman树"></a>Huffman树</h2><blockquote>
<p>参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43191865/article/details/97974221">https://blog.csdn.net/weixin_43191865/article/details/97974221</a></p>
</blockquote>
<p>一些概念：</p>
<ul>
<li>结点的带权路径长度：指的是从根结点到该结点之间的路径长度与该结点的权的乘积。</li>
<li>树的带权路径长度为树中所有叶子结点的带权路径长度之和，通常记作<code>WPL</code>。例如下图所示的这颗树的带权路径长度为：<code>WPL=7*1+5*2+2*3+4*3</code></li>
</ul>
<p><img src="https://s2.loli.net/2022/12/18/1CwKHR7EAjt2WUM.png" alt="9-1.png"></p>
<p>当用n个结点（都做叶子结点且都有各自的权值）试图构建一棵树时，如果构建的这棵树的带权路径长度最小，称这棵树为“最优二叉树”，有时也叫“赫夫曼树”或者“哈夫曼树”。在构建哈弗曼树时，只需要遵循一个原则：权重越大的结点离树根越近。</p>
<p>例如：3 4 5 8 ，设最后答案为ans</p>
<p>首先我们选3 4，合并节点，新点权值为7，并加入原序列，ans+=(3+4)</p>
<p><img src="https://bu.dusays.com/2023/04/02/64290c1eadee0.png" alt="9-2.png"></p>
<p>然后新序列中合并5和7，新点权值为12，ans+=(5+7)</p>
<p><img src="https://bu.dusays.com/2023/04/02/64290c1ebcd3e.png" alt="9-3.png"></p>
<p>最后合并12和8，新节点为20，跳出循环，ans+=(12+8)</p>
<p><img src="https://bu.dusays.com/2023/04/02/64290c1ecb63a.png" alt="9-4.png"></p>
<p>最后的哈夫曼树就是右边黑色的那棵树，答案就是ans。</p>
<p>对于某一个节点，因为其被合并之后的值给了新的节点，而新的节点合并的时候又会加上这个值，实际上是不断为答案作贡献的。</p>
<p><strong>k叉哈夫曼树：</strong> 为保证其根节点可以选到k个子树，假设节点个数为n，需要满足<code>(n-1)mod(k-1)==0</code>的条件，若不满足，为原序列<code>补0</code>。</p>
<p>例题：<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P2168">NOI2015荷马史诗</a></p>
<p>参考代码：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAX(a,b) ((a)&gt;(b)?(a):(b))</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> LL;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span>{</span><br><span class="line">    LL w,depth;</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> node&amp; v)<span class="type">const</span>{</span><br><span class="line">        <span class="keyword">if</span>(w!=v.w) <span class="keyword">return</span> w&gt;v.w;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> depth&gt;v.depth;</span><br><span class="line">    }</span><br><span class="line">};</span><br><span class="line">std::priority_queue&lt;node&gt; qwq;</span><br><span class="line">LL n,k,ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>,&amp;n,&amp;k);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++){</span><br><span class="line">        LL tempw;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>,&amp;tempw);</span><br><span class="line">        qwq.<span class="built_in">push</span>((node){tempw,<span class="number">1</span>});</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    LL qwqsize = qwq.<span class="built_in">size</span>();</span><br><span class="line">    <span class="keyword">while</span>((qwqsize<span class="number">-1</span>)%(k<span class="number">-1</span>)){</span><br><span class="line">        qwq.<span class="built_in">push</span>((node){<span class="number">0</span>,<span class="number">1</span>});</span><br><span class="line">        qwqsize++;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(qwqsize&gt;=k){</span><br><span class="line">        LL tw = <span class="number">0</span>,tdep = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=k; i++){</span><br><span class="line">            node tq = qwq.<span class="built_in">top</span>();</span><br><span class="line">            qwq.<span class="built_in">pop</span>(); qwqsize--;</span><br><span class="line">            tdep = <span class="built_in">MAX</span>(tdep,tq.depth);</span><br><span class="line">            tw += tq.w;</span><br><span class="line">        }</span><br><span class="line">        ans += tw;</span><br><span class="line">        qwq.<span class="built_in">push</span>((node){tw,tdep+<span class="number">1</span>});</span><br><span class="line">        qwqsize++;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n%lld"</span>,ans,qwq.<span class="built_in">top</span>().depth<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;       </span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h2 id="拓扑排序"><a href="#拓扑排序" class="headerlink" title="拓扑排序"></a>拓扑排序</h2><p>例题：<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P1983">https://www.luogu.com.cn/problem/P1983</a></p>
<p>参考代码：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1e3</span>+<span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM = <span class="number">5e7</span>+<span class="number">10</span>; <span class="comment">//算出来的空间花费远比这个多，windows会阻止运行，算错了？</span></span><br><span class="line"><span class="type">int</span> tot,head[MAXN],n,m,spot[MAXN],in[MAXN],ans;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Edge</span>{<span class="type">int</span> v,next;}edge[MAXM];</span><br><span class="line"><span class="type">bool</span> isspot[MAXN],has[MAXN][MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>{</span><br><span class="line">    edge[++tot].v=y;</span><br><span class="line">    edge[tot].next=head[x];</span><br><span class="line">    head[x]=tot;</span><br><span class="line">} <span class="comment">//本题不应当采用这种存图方式，但我直接用has数组避免重构了</span></span><br><span class="line"></span><br><span class="line">std::queue&lt;<span class="type">int</span>&gt; qwq;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">toposort</span><span class="params">()</span></span>{    <span class="comment">//这里的toposort为适应题目做了改造</span></span><br><span class="line">    <span class="type">int</span> cnt1 = <span class="number">0</span>, cnt2 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++){</span><br><span class="line">        <span class="keyword">if</span>(!in[i]){ </span><br><span class="line">            qwq.<span class="built_in">push</span>(i);</span><br><span class="line">            cnt1++;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(!qwq.<span class="built_in">empty</span>()){</span><br><span class="line">        <span class="type">int</span> x = qwq.<span class="built_in">front</span>();</span><br><span class="line">        qwq.<span class="built_in">pop</span>(); cnt1--;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=head[x];i;i=edge[i].next){</span><br><span class="line">            <span class="type">int</span> y=edge[i].v; in[y]--;</span><br><span class="line">            <span class="keyword">if</span>(!in[y]){</span><br><span class="line">                qwq.<span class="built_in">push</span>(y);</span><br><span class="line">                cnt2++;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span>(!cnt1){ans++; cnt1=cnt2; cnt2=<span class="number">0</span>;}  <span class="comment">//神之一手（雾）</span></span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++){</span><br><span class="line">        <span class="type">int</span> s; <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;s);</span><br><span class="line">        <span class="built_in">memset</span>(isspot,<span class="literal">false</span>,<span class="built_in">sizeof</span>(isspot));</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=s;j++){</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;spot[j]);</span><br><span class="line">            isspot[spot[j]]=<span class="literal">true</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=spot[<span class="number">1</span>];j&lt;=spot[s];j++){ <span class="comment">//连续站点枚举</span></span><br><span class="line">            <span class="keyword">if</span>(!isspot[j]){</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">1</span>;k&lt;=s;k++){</span><br><span class="line">                    <span class="keyword">if</span>(has[spot[k]][j])<span class="keyword">continue</span>;</span><br><span class="line">                    has[spot[k]][j] = <span class="literal">true</span>;</span><br><span class="line">                    <span class="built_in">addedge</span>(spot[k],j);</span><br><span class="line">                    in[j]++;</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="built_in">toposort</span>();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h2 id="最小生成树"><a href="#最小生成树" class="headerlink" title="最小生成树"></a>最小生成树</h2><p>给出一个无向图，求出最小生成树，如果该图不连通，则输出orz</p>
<p><strong>输入格式：</strong></p>
<p>第一行包含两个整数N、M，表示该图共有N个结点和M条无向边。（N&lt;=5000，M&lt;=200000）</p>
<p>接下来M行每行包含三个整数Xi、Yi、Zi，表示有一条长度为Zi的无向边连接结点Xi、Yi</p>
<p><strong>输出格式：</strong></p>
<p>输出包含一个数，即最小生成树的各边的长度之和；如果该图不连通则输出orz</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//kruscal</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">5000</span>+<span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM = <span class="number">200000</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Edge</span>{<span class="type">int</span> u,v,w;}edge[MAXM];</span><br><span class="line"><span class="type">int</span> uset[MAXN],n,m,ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span>{</span><br><span class="line">    <span class="keyword">if</span>(uset[x]!=x)uset[x]=<span class="built_in">find</span>(uset[x]);</span><br><span class="line">    <span class="keyword">return</span> uset[x];</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">unionset</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>{</span><br><span class="line">    x=<span class="built_in">find</span>(x);</span><br><span class="line">    y=<span class="built_in">find</span>(y);</span><br><span class="line">    <span class="keyword">if</span>(x==y)<span class="keyword">return</span>;</span><br><span class="line">    uset[x]=y;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmp</span><span class="params">(Edge x,Edge y)</span></span>{<span class="keyword">return</span> x.w&lt;y.w;}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++)</span><br><span class="line">    {</span><br><span class="line">        <span class="type">int</span> x,y,z;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;x,&amp;y,&amp;z);</span><br><span class="line">        edge[i].u=x;</span><br><span class="line">        edge[i].v=y;</span><br><span class="line">        edge[i].w=z;</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">sort</span>(edge+<span class="number">1</span>,edge+<span class="number">1</span>+m,cmp);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;=n;i++)uset[i]=i;</span><br><span class="line">    </span><br><span class="line">    <span class="type">int</span> cnt=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++)</span><br><span class="line">    {</span><br><span class="line">        <span class="type">int</span> x=<span class="built_in">find</span>(edge[i].u);</span><br><span class="line">        <span class="type">int</span> y=<span class="built_in">find</span>(edge[i].v);</span><br><span class="line">        <span class="keyword">if</span>(x==y)<span class="keyword">continue</span>;</span><br><span class="line">        ans+=edge[i].w;</span><br><span class="line">        <span class="built_in">unionset</span>(x,y);</span><br><span class="line">        <span class="keyword">if</span>(++cnt==n<span class="number">-1</span>)<span class="keyword">break</span>;</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(cnt&lt;n<span class="number">-1</span>)<span class="built_in">printf</span>(<span class="string">"orz"</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%d"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h2 id="单源最短路径"><a href="#单源最短路径" class="headerlink" title="单源最短路径"></a>单源最短路径</h2><p>给出一个有向图，请输出从某一点出发到所有点的最短路径长度。</p>
<p><strong>输入格式：</strong></p>
<p>第一行包含三个整数N、M、S，分别表示点的个数、有向边的个数、出发点的编号。</p>
<p>接下来M行每行包含三个整数Fi、Gi、Wi，分别表示第i条有向边的出发点、目标点和长度。</p>
<p><strong>输出格式：</strong></p>
<p>一行，包含N个用空格分隔的整数，其中第i个整数表示从点S出发到点i的最短路径长度（若S=i则最短路径长度为0，若从点S无法到达点i，则最短路径长度为2147483647）</p>
<p><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.05ex;" xmlns="http://www.w3.org/2000/svg" width="6.55ex" height="1.67ex" role="img" focusable="false" viewBox="0 -716 2895 738"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mi" transform="translate(645,0)"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mi" transform="translate(1396,0)"><path data-c="1D439" d="M48 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H742Q749 676 749 669Q749 664 736 557T722 447Q720 440 702 440H690Q683 445 683 453Q683 454 686 477T689 530Q689 560 682 579T663 610T626 626T575 633T503 634H480Q398 633 393 631Q388 629 386 623Q385 622 352 492L320 363H375Q378 363 398 363T426 364T448 367T472 374T489 386Q502 398 511 419T524 457T529 475Q532 480 548 480H560Q567 475 567 470Q567 467 536 339T502 207Q500 200 482 200H470Q463 206 463 212Q463 215 468 234T473 274Q473 303 453 310T364 317H309L277 190Q245 66 245 60Q245 46 334 46H359Q365 40 365 39T363 19Q359 6 353 0H336Q295 2 185 2Q120 2 86 2T48 1Z"></path></g><g data-mml-node="mi" transform="translate(2145,0)"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g></g></g></svg></mjx-container></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXM 500010</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXN 10010</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> INF 2147483647</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n,m,s,dis[MAXN];</span><br><span class="line"><span class="type">bool</span> inq[MAXN];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Edge</span>{<span class="type">int</span> v,w,next;}edge[MAXM];</span><br><span class="line"><span class="type">int</span> tot,head[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> z)</span></span>{</span><br><span class="line">    edge[++tot].v=y;</span><br><span class="line">    edge[tot].w=z;</span><br><span class="line">    edge[tot].next=head[x];</span><br><span class="line">    head[x]=tot;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">spfa</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    queue&lt;<span class="type">int</span>&gt; qwq;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)dis[i]=INF;</span><br><span class="line">    </span><br><span class="line">    qwq.<span class="built_in">push</span>(s);</span><br><span class="line">    dis[s]=<span class="number">0</span>;inq[s]=<span class="literal">true</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span>(!qwq.<span class="built_in">empty</span>())</span><br><span class="line">    {</span><br><span class="line">        <span class="type">int</span> x=qwq.<span class="built_in">front</span>();</span><br><span class="line">        qwq.<span class="built_in">pop</span>(); inq[x]=<span class="literal">false</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=head[x];i;i=edge[i].next){</span><br><span class="line">            <span class="type">int</span> y=edge[i].v;</span><br><span class="line">            <span class="keyword">if</span>(dis[y]&gt;dis[x]+edge[i].w){</span><br><span class="line">                dis[y]=dis[x]+edge[i].w;</span><br><span class="line">                <span class="keyword">if</span>(!inq[y]){qwq.<span class="built_in">push</span>(y);inq[y]=<span class="literal">true</span>;}</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;n,&amp;m,&amp;s);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++){</span><br><span class="line">        <span class="type">int</span> x,y,z;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;x,&amp;y,&amp;z);</span><br><span class="line">        <span class="built_in">addedge</span>(x,y,z);</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">spfa</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">     <span class="keyword">if</span>(s==i)<span class="built_in">printf</span>(<span class="string">"0 "</span>);</span><br><span class="line">     <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%d "</span>,dis[i]);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.462ex;" xmlns="http://www.w3.org/2000/svg" width="8.86ex" height="2.032ex" role="img" focusable="false" viewBox="0 -694 3916 898"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path></g><g data-mml-node="mi" transform="translate(828,0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(1173,0)"><path data-c="1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path></g><g data-mml-node="mi" transform="translate(1585,0)"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></g><g data-mml-node="mi" transform="translate(2106,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="mi" transform="translate(2575,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mi" transform="translate(2936,0)"><path data-c="1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(3387,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g></g></g></svg></mjx-container></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXM 200010</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXN 100010</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF =<span class="number">2147483647</span>;</span><br><span class="line"><span class="type">int</span> n,m,s,dis[MAXN];</span><br><span class="line"><span class="type">bool</span> done[MAXN];</span><br><span class="line"><span class="type">int</span> tot,head[MAXN];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Edge</span>{<span class="type">int</span> v,w,next;}edge[MAXM];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> z)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    edge[++tot].v=y;</span><br><span class="line">    edge[tot].w=z;</span><br><span class="line">    edge[tot].next=head[x];</span><br><span class="line">    head[x]=tot;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span>{</span><br><span class="line">    <span class="type">int</span> u,dist;</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> node&amp; v)<span class="type">const</span>{</span><br><span class="line">        <span class="keyword">return</span> dist&gt;v.dist;</span><br><span class="line">    }</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line">priority_queue&lt;node&gt; qwq;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">dijkstra</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)dis[i]=INF;</span><br><span class="line">    dis[s]=<span class="number">0</span>;</span><br><span class="line">    qwq.<span class="built_in">push</span>((node){s,<span class="number">0</span>});</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span>(!qwq.<span class="built_in">empty</span>())</span><br><span class="line">    {</span><br><span class="line">        node front=qwq.<span class="built_in">top</span>(); qwq.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="type">int</span> u=front.u,dist=front.dist;</span><br><span class="line">        <span class="keyword">if</span>(done[u])<span class="keyword">continue</span>;</span><br><span class="line">        done[u]=<span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=head[u];i;i=edge[i].next)</span><br><span class="line">        {</span><br><span class="line">            <span class="type">int</span> y=edge[i].v,z=edge[i].w;</span><br><span class="line">            <span class="keyword">if</span>(dis[u]+z&lt;dis[y])</span><br><span class="line">            {</span><br><span class="line">                dis[y]=dis[u]+z;</span><br><span class="line">                qwq.<span class="built_in">push</span>((node){y,dis[y]});</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;n,&amp;m,&amp;s);</span><br><span class="line">    <span class="type">int</span> x,y,z;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++){</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;x,&amp;y,&amp;z);</span><br><span class="line">        <span class="built_in">addedge</span>(x,y,z);</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">dijkstra</span>();</span><br><span class="line">    </span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)<span class="built_in">printf</span>(<span class="string">"%d "</span>,dis[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h2 id="树状数组"><a href="#树状数组" class="headerlink" title="树状数组"></a>树状数组</h2><p>已知一个数列，你需要进行下面两种操作：</p>
<p>1.将某一个数加上x</p>
<p>2.求出某区间每一个数的和</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> lowbit(x) (x&amp;(-x))</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">500010</span>;</span><br><span class="line"><span class="type">int</span> c[MAXN],n,m;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">sum</span><span class="params">(<span class="type">int</span> i)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="type">int</span> s=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(i&gt;<span class="number">0</span>){</span><br><span class="line">        s+=c[i];</span><br><span class="line">        i-=<span class="built_in">lowbit</span>(i);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> s;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">update</span><span class="params">(<span class="type">int</span> i,<span class="type">int</span> value)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="keyword">while</span>(i&lt;=n){</span><br><span class="line">        c[i]+=value;</span><br><span class="line">        i+=<span class="built_in">lowbit</span>(i);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	{</span><br><span class="line">        <span class="type">int</span> temp;<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;temp);</span><br><span class="line">        <span class="built_in">update</span>(i,temp);</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++)</span><br><span class="line">	{</span><br><span class="line">        <span class="type">int</span> flag,x,y;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;flag,&amp;x,&amp;y);</span><br><span class="line">        <span class="keyword">if</span>(flag==<span class="number">1</span>) <span class="built_in">update</span>(x,y);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,<span class="built_in">sum</span>(y)-<span class="built_in">sum</span>(x<span class="number">-1</span>));</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>已知一个数列，你需要进行下面两种操作：</p>
<p>1.将某区间每一个数数加上x</p>
<p>2.求出某一个数的值</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> lowbit(x) (x&amp;(-x))</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">500010</span>;</span><br><span class="line"><span class="type">int</span> c[MAXN],n,m,pre,now;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">sum</span><span class="params">(<span class="type">int</span> i)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="type">int</span> s=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(i&gt;<span class="number">0</span>){</span><br><span class="line">        s+=c[i];</span><br><span class="line">        i-=<span class="built_in">lowbit</span>(i);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> s;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">update</span><span class="params">(<span class="type">int</span> i,<span class="type">int</span> value)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="keyword">while</span>(i&lt;=n){</span><br><span class="line">        c[i]+=value;</span><br><span class="line">        i+=<span class="built_in">lowbit</span>(i);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line">    </span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	{</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;now);</span><br><span class="line">        <span class="built_in">update</span>(i,now-pre);</span><br><span class="line">        pre=now;</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++)</span><br><span class="line">	{</span><br><span class="line">        <span class="type">int</span> flag,x;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;flag,&amp;x);</span><br><span class="line">        <span class="keyword">if</span>(flag==<span class="number">1</span>)</span><br><span class="line">		{</span><br><span class="line">            <span class="type">int</span> y,k;<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;y,&amp;k);</span><br><span class="line">            <span class="built_in">update</span>(x,k);<span class="built_in">update</span>(y+<span class="number">1</span>,-k);</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,<span class="built_in">sum</span>(x));</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h2 id="最近公共祖先"><a href="#最近公共祖先" class="headerlink" title="最近公共祖先"></a>最近公共祖先</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">500010</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM = MAXN<span class="number">-1</span>;</span><br><span class="line"><span class="type">int</span> max0,n,m,tot,head[MAXN];</span><br><span class="line"><span class="type">int</span> fa[MAXN][<span class="number">25</span>],dep[MAXN],s;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Edge</span>{<span class="type">int</span> v,next;}edge[MAXM&lt;&lt;<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    edge[++tot].v=y;</span><br><span class="line">    edge[tot].next=head[x];</span><br><span class="line">    head[x]=tot;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">lcainit</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=max0;i++)</span><br><span class="line">    <span class="keyword">if</span>(fa[x][i<span class="number">-1</span>])fa[x][i]=fa[fa[x][i<span class="number">-1</span>]][i<span class="number">-1</span>];</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=head[x];i;i=edge[i].next){</span><br><span class="line">        <span class="type">int</span> y=edge[i].v;</span><br><span class="line">        <span class="keyword">if</span>(y!=fa[x][<span class="number">0</span>]){</span><br><span class="line">            fa[y][<span class="number">0</span>]=x;</span><br><span class="line">            dep[y]=dep[x]+<span class="number">1</span>;</span><br><span class="line">            <span class="built_in">lcainit</span>(y);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">lca</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="keyword">if</span>(dep[u]&lt;dep[v])<span class="built_in">swap</span>(u,v);</span><br><span class="line">    <span class="type">int</span> delta=dep[u]-dep[v];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> x=<span class="number">0</span>;x&lt;=max0;x++)</span><br><span class="line">    <span class="keyword">if</span>((<span class="number">1</span>&lt;&lt;x)&amp;delta)u=fa[u][x];</span><br><span class="line">    <span class="keyword">if</span>(u==v)<span class="keyword">return</span> u;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> x=max0;x&gt;=<span class="number">0</span>;x--)</span><br><span class="line">    <span class="keyword">if</span>(fa[u][x]!=fa[v][x]){</span><br><span class="line">        u=fa[u][x];</span><br><span class="line">        v=fa[v][x];</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> fa[u][<span class="number">0</span>];</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;n,&amp;m,&amp;s);</span><br><span class="line">    max0=(<span class="type">int</span>)(<span class="built_in">log</span>(n)/<span class="built_in">log</span>(<span class="number">2</span>))+<span class="number">3</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;n;i++){</span><br><span class="line">        <span class="type">int</span> x,y;<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</span><br><span class="line">        <span class="built_in">addedge</span>(x,y);<span class="built_in">addedge</span>(y,x);</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">lcainit</span>(s);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++){</span><br><span class="line">    	<span class="type">int</span> a,b;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;a,&amp;b);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,<span class="built_in">lca</span>(a,b));</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h2 id="割边"><a href="#割边" class="headerlink" title="割边"></a>割边</h2><p>提交入口：<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/T103481">https://www.luogu.com.cn/problem/T103481</a></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MIN(a,b) ((a)&lt;(b)?(a):(b))</span></span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">5e4</span>+<span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM = <span class="number">3e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="type">int</span> head[MAXN],tot,n,m,num,dfn[MAXN],low[MAXN],ans;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Edge</span>{<span class="type">int</span> v,next;}edge[MAXM&lt;&lt;<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>{</span><br><span class="line">    edge[++tot].v=y;</span><br><span class="line">    edge[tot].next=head[x];</span><br><span class="line">    head[x]=tot;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">tarjan</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> in_edge)</span></span>{</span><br><span class="line">    dfn[x]=low[x]=++num;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=head[x];i;i=edge[i].next){</span><br><span class="line">        <span class="type">int</span> y=edge[i].v;</span><br><span class="line">        <span class="keyword">if</span>(!dfn[y]){</span><br><span class="line">            <span class="built_in">tarjan</span>(y,i); <span class="comment">//把事情当作已经完成是理解递归的关键</span></span><br><span class="line">            low[x]=<span class="built_in">MIN</span>(low[x], low[y]);</span><br><span class="line">            <span class="keyword">if</span>(dfn[x]&lt;low[y]) ans++; <span class="comment">//割边判定</span></span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(i!=(in_edge^<span class="number">1</span>))</span><br><span class="line">            low[x]=<span class="built_in">MIN</span>(low[x], dfn[y]);</span><br><span class="line">        <span class="comment">//不能通过来时的对应边访问父亲，但可以通过其他重边访问父亲</span></span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line">    tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++){</span><br><span class="line">        <span class="type">int</span> x,y; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</span><br><span class="line">        <span class="built_in">addedge</span>(x,y); <span class="built_in">addedge</span>(y,x);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">        <span class="keyword">if</span>(!dfn[i]) <span class="built_in">tarjan</span>(i,<span class="number">0</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>若需要输出割边：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MIN(a,b) ((a)&lt;(b)?(a):(b))</span></span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">5e4</span>+<span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM = <span class="number">3e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="type">int</span> head[MAXN],tot,n,m,num,dfn[MAXN],low[MAXN];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Edge</span>{<span class="type">int</span> v,next;}edge[MAXM&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="type">bool</span> isbridge[MAXM&lt;&lt;<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>{</span><br><span class="line">    edge[++tot].v=y;</span><br><span class="line">    edge[tot].next=head[x];</span><br><span class="line">    head[x]=tot;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">tarjan</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> in_edge)</span></span>{</span><br><span class="line">    dfn[x]=low[x]=++num;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=head[x];i;i=edge[i].next){</span><br><span class="line">        <span class="type">int</span> y=edge[i].v;</span><br><span class="line">        <span class="keyword">if</span>(!dfn[y]){</span><br><span class="line">            <span class="built_in">tarjan</span>(y,i); <span class="comment">//把事情当作已经完成是理解递归的关键</span></span><br><span class="line">            low[x]=<span class="built_in">MIN</span>(low[x], low[y]);</span><br><span class="line">            <span class="keyword">if</span>(dfn[x]&lt;low[y]){</span><br><span class="line">                isbridge[i]=isbridge[i^<span class="number">1</span>]=<span class="literal">true</span>;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(i!=(in_edge^<span class="number">1</span>))</span><br><span class="line">            low[x]=<span class="built_in">MIN</span>(low[x], dfn[y]);</span><br><span class="line">        <span class="comment">//不能通过来时的对应边访问父亲，但可以通过其他重边访问父亲</span></span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line">    tot = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++){</span><br><span class="line">        <span class="type">int</span> x,y; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</span><br><span class="line">        <span class="built_in">addedge</span>(x,y); <span class="built_in">addedge</span>(y,x);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">        <span class="keyword">if</span>(!dfn[i]) <span class="built_in">tarjan</span>(i,<span class="number">0</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>; i&lt;tot; i+=<span class="number">2</span>) <span class="comment">//无向图</span></span><br><span class="line">        <span class="keyword">if</span>(isbridge[i]) <span class="comment">//i^1在前是因为edge[].v是到达的点</span></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d %d\n"</span>,edge[i^<span class="number">1</span>].v,edge[i].v);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h2 id="割点"><a href="#割点" class="headerlink" title="割点"></a>割点</h2><p>提交入口： <a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P3388">https://www.luogu.com.cn/problem/P3388</a></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MIN(a,b) ((a)&lt;(b)?(a):(b))</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">2e4</span>+<span class="number">3</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM = <span class="number">1e5</span>+<span class="number">3</span>;</span><br><span class="line"><span class="type">int</span> n,m,head[MAXN],tot,ans;</span><br><span class="line"><span class="type">int</span> num,dfn[MAXN],low[MAXN],sroot;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Edge</span>{<span class="type">int</span> v,next;}edge[MAXM&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="type">bool</span> iscut[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span>{</span><br><span class="line">    edge[++tot].v=y;</span><br><span class="line">    edge[tot].next=head[x];</span><br><span class="line">    head[x]=tot;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">tarjan</span><span class="params">(<span class="type">int</span> x)</span></span>{</span><br><span class="line">    dfn[x]=low[x]=++num;</span><br><span class="line">    <span class="type">int</span> mflag = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=head[x];i;i=edge[i].next){</span><br><span class="line">        <span class="type">int</span> y=edge[i].v;</span><br><span class="line">        <span class="keyword">if</span>(!dfn[y]){</span><br><span class="line">            <span class="built_in">tarjan</span>(y);</span><br><span class="line">            low[x]=<span class="built_in">MIN</span>(low[x],low[y]);</span><br><span class="line">            <span class="keyword">if</span>(low[y]&gt;=dfn[x]){</span><br><span class="line">                mflag++; </span><br><span class="line">                <span class="keyword">if</span>(x!=sroot || mflag&gt;<span class="number">1</span>)iscut[x]=<span class="literal">true</span>;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">else</span> low[x]=<span class="built_in">MIN</span>(low[x],dfn[y]);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++){</span><br><span class="line">        <span class="type">int</span> x,y; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</span><br><span class="line">        <span class="keyword">if</span>(x==y)<span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">addedge</span>(x,y); <span class="built_in">addedge</span>(y,x);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">        <span class="keyword">if</span>(!dfn[i])sroot=i,<span class="built_in">tarjan</span>(i);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">        <span class="keyword">if</span>(iscut[i])ans++;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">        <span class="keyword">if</span>(iscut[i])<span class="built_in">printf</span>(<span class="string">"%d "</span>,i);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h2 id="强连通分量缩点"><a href="#强连通分量缩点" class="headerlink" title="强连通分量缩点"></a>强连通分量缩点</h2><p>题目描述：<a target="_blank" rel="noopener" href="https://www.luogu.org/problemnew/show/P3387">https://www.luogu.org/problemnew/show/P3387</a></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAX(a,b) ((a)&gt;(b)?(a):(b))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MIN(a,b) ((a)&lt;(b)?(a):(b))</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn=<span class="number">1e4</span>+<span class="number">3</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxm=<span class="number">1e5</span>+<span class="number">3</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Edge</span>{<span class="type">int</span> v,next;};</span><br><span class="line">Edge edge[maxm],edge2[maxm];</span><br><span class="line"><span class="type">int</span> head[maxn],w[maxn],dfn[maxn],low[maxn],stac[maxn],color[maxn];</span><br><span class="line"><span class="type">int</span> n,m,tot,num,top,cnt,ans;</span><br><span class="line"><span class="type">int</span> head2[maxn],W[maxn],tot2,sum[maxn];</span><br><span class="line"><span class="type">bool</span> ins[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>{</span><br><span class="line">    edge[++tot].v=y;</span><br><span class="line">    edge[tot].next=head[x];</span><br><span class="line">    head[x]=tot;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">addedge2</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>{</span><br><span class="line">    edge2[++tot2].v=y;</span><br><span class="line">    edge2[tot2].next=head2[x];</span><br><span class="line">    head2[x]=tot2;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">input</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;w[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++){</span><br><span class="line">        <span class="type">int</span> x,y;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</span><br><span class="line">        <span class="built_in">addedge</span>(x,y);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x)</span></span>{</span><br><span class="line">    <span class="keyword">if</span>(sum[x])<span class="keyword">return</span> sum[x];</span><br><span class="line">    <span class="type">int</span> temp=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=head2[x];i;i=edge2[i].next){</span><br><span class="line">        temp=<span class="built_in">MAX</span>(temp,<span class="built_in">dfs</span>(edge2[i].v));</span><br><span class="line">    }</span><br><span class="line">    sum[x]=W[x]+temp;</span><br><span class="line">    <span class="keyword">return</span> sum[x];</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">tarjan</span><span class="params">(<span class="type">int</span> x)</span></span>{</span><br><span class="line">    low[x]=dfn[x]=++num;</span><br><span class="line">    stac[++top]=x; ins[x]=<span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=head[x];i;i=edge[i].next){</span><br><span class="line">        <span class="type">int</span> y=edge[i].v;</span><br><span class="line">        <span class="keyword">if</span>(!dfn[y]){</span><br><span class="line">            <span class="built_in">tarjan</span>(y);</span><br><span class="line">            low[x]=<span class="built_in">MIN</span>(low[x],low[y]);</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(ins[y]){</span><br><span class="line">            low[x]=<span class="built_in">MIN</span>(low[x],dfn[y]);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">if</span>(dfn[x]==low[x]){</span><br><span class="line">        ++cnt; <span class="type">int</span> y;</span><br><span class="line">        <span class="keyword">do</span>{</span><br><span class="line">            y=stac[top--]; ins[y]=<span class="literal">false</span>;</span><br><span class="line">            color[y]=cnt;</span><br><span class="line">            W[cnt]+=w[y];</span><br><span class="line">        }<span class="keyword">while</span>(x!=y);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="built_in">input</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++){</span><br><span class="line">        <span class="keyword">if</span>(!dfn[i])<span class="built_in">tarjan</span>(i);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> x=<span class="number">1</span>;x&lt;=n;x++){</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=head[x];i;i=edge[i].next){</span><br><span class="line">            <span class="type">int</span> y=edge[i].v;</span><br><span class="line">            <span class="keyword">if</span>(color[x]!=color[y]){</span><br><span class="line">                <span class="built_in">addedge2</span>(color[x],color[y]);</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=cnt;i++){</span><br><span class="line">        <span class="keyword">if</span>(!sum[i]){</span><br><span class="line">            ans=<span class="built_in">MAX</span>(ans,<span class="built_in">dfs</span>(i));</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h2 id="非压位高精"><a href="#非压位高精" class="headerlink" title="非压位高精"></a>非压位高精</h2><p>虽然重载的运算符两边数据类型都是Bigint，但因为自动强制转换，所以用[Bigint] * [int]也不会错。</p>
<p>在大数除int、大数对int取余时，效率不及专门功能的函数</p>
<p>参考：CSDN用户 代号4101</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAX(a,b) ((a)&gt;(b)?(a):(b))</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXLEN = <span class="number">1000</span>;  <span class="comment">//最长的数字长度</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Bigint</span>{</span><br><span class="line">    <span class="type">int</span> d[MAXLEN],len;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">clean</span><span class="params">()</span></span>{<span class="keyword">while</span>(len&gt;<span class="number">1</span>&amp;&amp;!d[len<span class="number">-1</span>])len--;} <span class="comment">//去前导0</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">Bigint</span>(){<span class="built_in">memset</span>(d,<span class="number">0</span>,<span class="built_in">sizeof</span>(d));len=<span class="number">1</span>;}</span><br><span class="line">    <span class="built_in">Bigint</span>(<span class="type">int</span> num){*<span class="keyword">this</span>=num;}</span><br><span class="line">    <span class="built_in">Bigint</span>(<span class="type">char</span>* num){*<span class="keyword">this</span>=num;}</span><br><span class="line"></span><br><span class="line">    Bigint <span class="keyword">operator</span> = (<span class="type">const</span> <span class="type">char</span>* num){</span><br><span class="line">        len=<span class="built_in">strlen</span>(num);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;len;i++)d[i]=num[len<span class="number">-1</span>-i]-<span class="string">'0'</span>;</span><br><span class="line">        <span class="built_in">clean</span>();</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    Bigint <span class="keyword">operator</span> = (<span class="type">int</span> num){</span><br><span class="line">        <span class="type">char</span> s[MAXLEN];</span><br><span class="line">        <span class="built_in">sprintf</span>(s,<span class="string">"%d"</span>,num);</span><br><span class="line">        *<span class="keyword">this</span>=s;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    Bigint <span class="keyword">operator</span> + (<span class="type">const</span> Bigint&amp; b){ <span class="comment">//只能大数加小数</span></span><br><span class="line">        Bigint c=*<span class="keyword">this</span>; <span class="type">int</span> i;</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;b.len;i++){</span><br><span class="line">            c.d[i]+=b.d[i];</span><br><span class="line">            <span class="keyword">if</span>(c.d[i]&gt;<span class="number">9</span>)c.d[i]%=<span class="number">10</span>,c.d[i+<span class="number">1</span>]++;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">while</span>(c.d[i]&gt;<span class="number">9</span>)c.d[i++]%=<span class="number">10</span>,c.d[i]++;</span><br><span class="line">        c.len=<span class="built_in">MAX</span>(len,b.len);</span><br><span class="line">        <span class="keyword">if</span>(c.d[i]&amp;&amp;c.len&lt;=i)c.len=i+<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> c;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    Bigint <span class="keyword">operator</span> - (<span class="type">const</span> Bigint&amp; b){ <span class="comment">//不能用小数减大数</span></span><br><span class="line">        Bigint c=*<span class="keyword">this</span>; <span class="type">int</span> i;</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;b.len;i++){</span><br><span class="line">            c.d[i]-=b.d[i];</span><br><span class="line">            <span class="keyword">if</span>(c.d[i]&lt;<span class="number">0</span>)c.d[i]+=<span class="number">10</span>,c.d[i+<span class="number">1</span>]--;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">while</span>(c.d[i]&lt;<span class="number">0</span>)c.d[i++]+=<span class="number">10</span>,c.d[i]--;</span><br><span class="line">        c.<span class="built_in">clean</span>();</span><br><span class="line">        <span class="keyword">return</span> c;</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    Bigint <span class="keyword">operator</span> * (<span class="type">const</span> Bigint&amp; b)<span class="type">const</span>{</span><br><span class="line">        <span class="type">int</span> i,j; Bigint c;</span><br><span class="line">        c.len=len+b.len;</span><br><span class="line">        <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;b.len;j++)</span><br><span class="line">            <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;len;i++)</span><br><span class="line">                c.d[i+j]+=d[i]*b.d[j];</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;c.len<span class="number">-1</span>;i++)</span><br><span class="line">            c.d[i+<span class="number">1</span>]+=c.d[i]/<span class="number">10</span>,c.d[i]%=<span class="number">10</span>;</span><br><span class="line">        c.<span class="built_in">clean</span>();</span><br><span class="line">        <span class="keyword">return</span> c;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    Bigint <span class="keyword">operator</span> / (<span class="type">const</span> Bigint&amp; b){</span><br><span class="line">        <span class="type">int</span> i,j;</span><br><span class="line">        Bigint c=*<span class="keyword">this</span>,a=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(i=len<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--){</span><br><span class="line">            a=a*<span class="number">10</span>+d[i];</span><br><span class="line">            <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">10</span>;j++)<span class="keyword">if</span>(a&lt;b*(j+<span class="number">1</span>))<span class="keyword">break</span>;</span><br><span class="line">            c.d[i]=j;</span><br><span class="line">            a=a-b*j;</span><br><span class="line">        }</span><br><span class="line">        c.<span class="built_in">clean</span>();</span><br><span class="line">        <span class="keyword">return</span> c;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    Bigint <span class="keyword">operator</span> % (<span class="type">const</span> Bigint&amp; b){</span><br><span class="line">        <span class="type">int</span> i,j; Bigint a=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(i=len<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--){</span><br><span class="line">            a=a*<span class="number">10</span>+d[i];</span><br><span class="line">            <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">10</span>;j++)<span class="keyword">if</span>(a&lt;b*(j+<span class="number">1</span>))<span class="keyword">break</span>;</span><br><span class="line">            a=a-b*j;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    Bigint <span class="keyword">operator</span> += (<span class="type">const</span> Bigint&amp; b){</span><br><span class="line">        *<span class="keyword">this</span>=*<span class="keyword">this</span>+b;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span> &lt; (<span class="type">const</span> Bigint&amp; b)<span class="type">const</span>{</span><br><span class="line">        <span class="keyword">if</span>(len!=b.len)<span class="keyword">return</span> len&lt;b.len;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=len<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--)</span><br><span class="line">            <span class="keyword">if</span>(d[i]!=b.d[i])<span class="keyword">return</span> d[i]&lt;b.d[i];</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span> &gt; (<span class="type">const</span> Bigint&amp; b)<span class="type">const</span>{<span class="keyword">return</span> b&lt;*<span class="keyword">this</span>;}</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span> &lt;= (<span class="type">const</span> Bigint&amp; b)<span class="type">const</span>{<span class="keyword">return</span> !(b&lt;*<span class="keyword">this</span>);}</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span> &gt;= (<span class="type">const</span> Bigint&amp; b)<span class="type">const</span>{<span class="keyword">return</span> !(*<span class="keyword">this</span>&lt;b);}</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span> != (<span class="type">const</span> Bigint&amp; b)<span class="type">const</span>{<span class="keyword">return</span> b&lt;*<span class="keyword">this</span>||*<span class="keyword">this</span>&lt;b;}</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span> == (<span class="type">const</span> Bigint&amp; b)<span class="type">const</span>{<span class="keyword">return</span> !(b&lt;*<span class="keyword">this</span>)&amp;&amp;!(b&gt;*<span class="keyword">this</span>);}</span><br><span class="line"></span><br><span class="line">    <span class="function">string <span class="title">str</span><span class="params">()</span><span class="type">const</span></span>{</span><br><span class="line">        <span class="type">char</span> s[MAXLEN]={};</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;len;i++)s[len<span class="number">-1</span>-i]=d[i]+<span class="string">'0'</span>;</span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    }</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line">istream&amp; <span class="keyword">operator</span> &gt;&gt; (istream&amp; in,Bigint&amp; x){</span><br><span class="line">    string s; in&gt;&gt;s;</span><br><span class="line">    x=s.<span class="built_in">c_str</span>();</span><br><span class="line">    <span class="keyword">return</span> in;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">ostream&amp; <span class="keyword">operator</span> &lt;&lt; (ostream&amp; out,<span class="type">const</span> Bigint&amp; x){</span><br><span class="line">    out&lt;&lt;x.<span class="built_in">str</span>();</span><br><span class="line">    <span class="keyword">return</span> out;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>{     <span class="comment">//just an example...</span></span><br><span class="line">    Bigint s=<span class="number">0</span>,t;</span><br><span class="line">	<span class="keyword">while</span>(cin&gt;&gt;t){</span><br><span class="line">		<span class="keyword">if</span>(t.len==<span class="number">1</span>&amp;&amp;!t.d[<span class="number">0</span>])<span class="keyword">break</span>;</span><br><span class="line">		s=s+t;</span><br><span class="line">	}</span><br><span class="line">	cout&lt;&lt;s&lt;&lt;endl;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h2 id="压位高精"><a href="#压位高精" class="headerlink" title="压位高精"></a>压位高精</h2><p>题面：<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P2152">https://www.luogu.com.cn/problem/P2152</a></p>
<p>自己缝的稍慢版本：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ctype.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> LL;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">int</span> uint;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rint register int</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAX(a,b) ((a)&gt;(b)?(a):(b))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MIN(a,b) ((a)&lt;(b)?(a):(b))</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">rd</span><span class="params">()</span> </span>{</span><br><span class="line">	<span class="type">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="type">char</span> ch=<span class="built_in">getchar</span>();</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(ch)) {<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=<span class="number">-1</span>;ch=<span class="built_in">getchar</span>();}</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch))x=x*<span class="number">10</span>+(ch^<span class="number">48</span>),ch=<span class="built_in">getchar</span>();</span><br><span class="line">	<span class="keyword">return</span> x*f;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">10010</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> base=<span class="number">10000</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> limit=<span class="number">4</span>;</span><br><span class="line"><span class="type">int</span> power_10[]={<span class="number">1</span>,<span class="number">10</span>,<span class="number">100</span>,<span class="number">1000</span>,<span class="number">1000</span>,<span class="number">10000</span>};</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Bigint</span> {</span><br><span class="line">	<span class="type">int</span> a[N],len;</span><br><span class="line">	<span class="built_in">Bigint</span>(){<span class="built_in">memset</span>(a,<span class="number">0</span>,<span class="built_in">sizeof</span>(a)),len=<span class="number">0</span>;}</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">clean</span><span class="params">()</span></span>{<span class="keyword">while</span>(len&gt;<span class="number">1</span>&amp;&amp;!a[len<span class="number">-1</span>])len--;} <span class="comment">//去前导0</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(LL x)</span> </span>{</span><br><span class="line">		<span class="keyword">while</span>(x)a[len++]=x%base,x/=base;</span><br><span class="line">	}</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">read</span><span class="params">()</span> </span>{</span><br><span class="line">		<span class="type">char</span> s[N];</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>,s);</span><br><span class="line">		len=<span class="number">1</span>;</span><br><span class="line">		<span class="type">int</span> n=<span class="built_in">strlen</span>(s),t=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(rint i=n<span class="number">-1</span>;~i;--i,++t) {</span><br><span class="line">			a[len<span class="number">-1</span>]+=(s[i]-<span class="string">'0'</span>)*power_10[t];</span><br><span class="line">			<span class="keyword">if</span>(t+<span class="number">1</span>==limit)t=<span class="number">-1</span>,++len;</span><br><span class="line">		}</span><br><span class="line">		<span class="keyword">if</span>(!t)--len;</span><br><span class="line">	}</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">print</span><span class="params">(<span class="type">char</span> c=<span class="number">-1</span>)</span> </span>{</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%lld"</span>,a[len<span class="number">-1</span>]);</span><br><span class="line">		<span class="keyword">for</span>(rint i=len<span class="number">-2</span>;i&gt;=<span class="number">0</span>;--i)<span class="built_in">printf</span>(<span class="string">"%0*lld"</span>,limit,a[i]);</span><br><span class="line">		<span class="keyword">if</span>(~c)<span class="built_in">putchar</span>(c);</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">    <span class="built_in">Bigint</span>(<span class="type">int</span> num){*<span class="keyword">this</span>=num;}</span><br><span class="line">    <span class="built_in">Bigint</span>(<span class="type">char</span>* num){*<span class="keyword">this</span>=num;}</span><br><span class="line">    Bigint <span class="keyword">operator</span> = (<span class="type">const</span> <span class="type">char</span>* num){</span><br><span class="line">        len=<span class="built_in">strlen</span>(num);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;len;i++)a[i]=num[len<span class="number">-1</span>-i]-<span class="string">'0'</span>;</span><br><span class="line">        <span class="built_in">clean</span>();</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    }</span><br><span class="line">    Bigint <span class="keyword">operator</span> = (<span class="type">int</span> num){</span><br><span class="line">        <span class="type">char</span> s[N];</span><br><span class="line">        <span class="built_in">sprintf</span>(s,<span class="string">"%d"</span>,num);</span><br><span class="line">        *<span class="keyword">this</span>=s;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span> &lt; (<span class="type">const</span> Bigint&amp; b)<span class="type">const</span>{</span><br><span class="line">        <span class="keyword">if</span>(len!=b.len)<span class="keyword">return</span> len&lt;b.len;</span><br><span class="line">        <span class="keyword">for</span>(rint i=len<span class="number">-1</span>;~i;i--)</span><br><span class="line">            <span class="keyword">if</span>(a[i]!=b.a[i])<span class="keyword">return</span> a[i]&lt;b.a[i];</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span> &gt; (<span class="type">const</span> Bigint&amp; b)<span class="type">const</span>{<span class="keyword">return</span> b&lt;*<span class="keyword">this</span>;}</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span> &lt;= (<span class="type">const</span> Bigint&amp; b)<span class="type">const</span>{<span class="keyword">return</span> !(b&lt;*<span class="keyword">this</span>);}</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span> &gt;= (<span class="type">const</span> Bigint&amp; b)<span class="type">const</span>{<span class="keyword">return</span> !(*<span class="keyword">this</span>&lt;b);}</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span> != (<span class="type">const</span> Bigint&amp; b)<span class="type">const</span>{<span class="keyword">return</span> b&lt;*<span class="keyword">this</span>||*<span class="keyword">this</span>&lt;b;}</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span> == (<span class="type">const</span> Bigint&amp; b)<span class="type">const</span>{<span class="keyword">return</span> !(b&lt;*<span class="keyword">this</span>)&amp;&amp;!(b&gt;*<span class="keyword">this</span>);}</span><br><span class="line">};</span><br><span class="line">Bigint <span class="keyword">operator</span> + (<span class="type">const</span> Bigint &amp;a,<span class="type">const</span> Bigint &amp;b) {</span><br><span class="line">	Bigint c;<span class="type">int</span> mx=<span class="built_in">MAX</span>(a.len,b.len);c.len=mx;</span><br><span class="line">	<span class="keyword">for</span>(rint i=<span class="number">0</span>;i&lt;mx;++i)c.a[i]=a.a[i]+b.a[i];</span><br><span class="line">	<span class="keyword">for</span>(rint i=<span class="number">0</span>;i&lt;mx;++i)<span class="keyword">if</span>(c.a[i]&gt;=base)++c.a[i+<span class="number">1</span>],c.a[i]-=base;</span><br><span class="line">	<span class="keyword">if</span>(c.a[c.len])++c.len;</span><br><span class="line">	<span class="keyword">return</span> c;</span><br><span class="line">}</span><br><span class="line">Bigint <span class="keyword">operator</span> - (<span class="type">const</span> Bigint &amp;a,<span class="type">const</span> Bigint &amp;b) {</span><br><span class="line">	Bigint c;<span class="type">int</span> mx=a.len;c.len=mx;</span><br><span class="line">	<span class="keyword">for</span>(rint i=<span class="number">0</span>;i&lt;mx;++i)c.a[i]=a.a[i]-b.a[i];</span><br><span class="line">	<span class="keyword">for</span>(rint i=<span class="number">0</span>;i&lt;mx;++i)<span class="keyword">if</span>(c.a[i]&lt;<span class="number">0</span>)--c.a[i+<span class="number">1</span>],c.a[i]+=base;</span><br><span class="line">	<span class="keyword">while</span>(c.len&amp;&amp;!c.a[c.len<span class="number">-1</span>])--c.len;</span><br><span class="line">	<span class="keyword">return</span> c;</span><br><span class="line">}</span><br><span class="line">Bigint <span class="keyword">operator</span> * (<span class="type">const</span> Bigint &amp;a,<span class="type">const</span> Bigint &amp;b) {</span><br><span class="line">	Bigint c;<span class="type">int</span> mx=a.len+b.len<span class="number">-1</span>;c.len=mx;</span><br><span class="line">	<span class="keyword">for</span>(rint i=<span class="number">0</span>,mxa=a.len;i&lt;mxa;++i)</span><br><span class="line">		<span class="keyword">for</span>(rint j=<span class="number">0</span>,mxb=b.len;j&lt;mxb;++j) {</span><br><span class="line">			c.a[i+j]+=a.a[i]*b.a[j];</span><br><span class="line">			<span class="keyword">if</span>(c.a[i+j]&gt;=base)c.a[i+j+<span class="number">1</span>]+=c.a[i+j]/base,c.a[i+j]%=base;</span><br><span class="line">		}</span><br><span class="line">	<span class="keyword">if</span>(c.a[c.len])++c.len;</span><br><span class="line">	<span class="keyword">return</span> c; </span><br><span class="line">}</span><br><span class="line">Bigint <span class="keyword">operator</span> / (<span class="type">const</span> Bigint &amp;a,<span class="type">const</span> <span class="type">int</span> &amp;b) {</span><br><span class="line">	Bigint c;<span class="type">int</span> mx=a.len;</span><br><span class="line">	LL now=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(rint i=mx<span class="number">-1</span>,s=<span class="number">0</span>;~i;--i) {</span><br><span class="line">		now=now*base+a.a[i];</span><br><span class="line">		<span class="keyword">if</span>(now/b)s=<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span>(!s)<span class="keyword">continue</span>;</span><br><span class="line">		c.a[c.len++]=now/b;</span><br><span class="line">		now%=b;</span><br><span class="line">	}</span><br><span class="line">	<span class="built_in">reverse</span>(c.a,c.a+c.len);</span><br><span class="line">	<span class="keyword">return</span> c;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function">Bigint <span class="title">biggcd</span><span class="params">(Bigint x,Bigint y)</span></span>{</span><br><span class="line">    <span class="type">int</span> xcnt2=<span class="number">0</span>, ycnt2=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(!(x.a[<span class="number">0</span>]&amp;<span class="number">1</span>)){xcnt2++; x=x/<span class="number">2</span>;}</span><br><span class="line">    <span class="keyword">while</span>(!(y.a[<span class="number">0</span>]&amp;<span class="number">1</span>)){ycnt2++; y=y/<span class="number">2</span>;}</span><br><span class="line">    <span class="type">int</span> z=<span class="built_in">MIN</span>(xcnt2,ycnt2);</span><br><span class="line">    <span class="keyword">while</span>(x!=y){</span><br><span class="line">        <span class="keyword">if</span>(x&lt;y){<span class="built_in">swap</span>(x,y);}</span><br><span class="line">        x=x-y;</span><br><span class="line">        <span class="keyword">while</span>(!(x.a[<span class="number">0</span>]&amp;<span class="number">1</span>)){x=x/<span class="number">2</span>;}</span><br><span class="line">    }</span><br><span class="line">    Bigint temp = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">while</span>(z--){x=x*temp;}</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">    Bigint a,b;</span><br><span class="line">    a.<span class="built_in">read</span>(); b.<span class="built_in">read</span>();</span><br><span class="line">    <span class="built_in">biggcd</span>(a,b).<span class="built_in">print</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>下面给出更好的版本，注意与原代码有改动：</p>
<ul>
<li>增加了<code>biggcd</code></li>
<li>在 class 中图省事将所有权限改成了 public ，这并不推荐</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//来源: https://paste.ubuntu.com/p/7VKYzpC7dn/</span></span><br><span class="line"><span class="comment">//作者：小黑AWM+MashPlant</span></span><br><span class="line"><span class="comment">//注：可以直接把BigInt和一样用cin cout都行，就是高精乘为了速度才用了FFT降低了精度，有需要可以自行更改。</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAX(a,b) ((a)&gt;(b)?(a):(b))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MIN(a,b) ((a)&lt;(b)?(a):(b))</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">double</span> PI = <span class="built_in">acos</span>(<span class="number">-1.0</span>);</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Complex</span>{</span><br><span class="line">    <span class="type">double</span> x,y;</span><br><span class="line">    <span class="built_in">Complex</span>(<span class="type">double</span> _x = <span class="number">0.0</span>,<span class="type">double</span> _y = <span class="number">0.0</span>){</span><br><span class="line">        x = _x;</span><br><span class="line">        y = _y;</span><br><span class="line">    }</span><br><span class="line">    Complex <span class="keyword">operator</span>-(<span class="type">const</span> Complex &amp;b)<span class="type">const</span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Complex</span>(x - b.x,y - b.y);</span><br><span class="line">    }</span><br><span class="line">    Complex <span class="keyword">operator</span>+(<span class="type">const</span> Complex &amp;b)<span class="type">const</span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Complex</span>(x + b.x,y + b.y);</span><br><span class="line">    }</span><br><span class="line">    Complex <span class="keyword">operator</span>*(<span class="type">const</span> Complex &amp;b)<span class="type">const</span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Complex</span>(x*b.x - y*b.y,x*b.y + y*b.x);</span><br><span class="line">    }</span><br><span class="line">};</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(Complex y[],<span class="type">int</span> len)</span></span>{</span><br><span class="line">    <span class="type">int</span> i,j,k;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>,j = len/<span class="number">2</span>;i&lt;len<span class="number">-1</span>;i++){</span><br><span class="line">        <span class="keyword">if</span>(i &lt; j)    <span class="built_in">swap</span>(y[i],y[j]);</span><br><span class="line">        k = len/<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">while</span>(j &gt;= k){</span><br><span class="line">            j = j - k;</span><br><span class="line">            k = k/<span class="number">2</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span>(j &lt; k)    j+=k;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">fft</span><span class="params">(Complex y[],<span class="type">int</span> len,<span class="type">int</span> on)</span></span>{</span><br><span class="line">    <span class="built_in">change</span>(y,len);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> h = <span class="number">2</span>;h &lt;= len;h&lt;&lt;=<span class="number">1</span>){</span><br><span class="line">        <span class="function">Complex <span class="title">wn</span><span class="params">(cos(on*<span class="number">2</span>*PI/h),sin(on*<span class="number">2</span>*PI/h))</span></span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>;j &lt; len;j += h){</span><br><span class="line">            <span class="function">Complex <span class="title">w</span><span class="params">(<span class="number">1</span>,<span class="number">0</span>)</span></span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> k = j;k &lt; j + h/<span class="number">2</span>;k++){</span><br><span class="line">                Complex u = y[k];</span><br><span class="line">                Complex t = w*y[k + h/<span class="number">2</span>];</span><br><span class="line">                y[k] = u + t;</span><br><span class="line">                y[k + h/<span class="number">2</span>] = u - t;</span><br><span class="line">                w = w*wn;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">if</span>(on == <span class="number">-1</span>){</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i &lt; len;i++){</span><br><span class="line">            y[i].x /= len;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BigInt</span></span><br><span class="line">{</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> Value(x, nega) ((nega) ? -(x) : (x))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> At(vec, index) ((index) &lt; vec.size() ? vec[(index)] : 0)</span></span><br><span class="line">    <span class="function"><span class="type">static</span> <span class="type">int</span> <span class="title">absComp</span><span class="params">(<span class="type">const</span> BigInt &amp;lhs, <span class="type">const</span> BigInt &amp;rhs)</span></span></span><br><span class="line"><span class="function">    </span>{</span><br><span class="line">        <span class="keyword">if</span> (lhs.<span class="built_in">size</span>() != rhs.<span class="built_in">size</span>())</span><br><span class="line">            <span class="keyword">return</span> lhs.<span class="built_in">size</span>() &lt; rhs.<span class="built_in">size</span>() ? <span class="number">-1</span> : <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = lhs.<span class="built_in">size</span>() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line">            <span class="keyword">if</span> (lhs[i] != rhs[i])</span><br><span class="line">                <span class="keyword">return</span> lhs[i] &lt; rhs[i] ? <span class="number">-1</span> : <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">using</span> Long = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line">    <span class="type">const</span> <span class="type">static</span> <span class="type">int</span> Exp = <span class="number">9</span>;</span><br><span class="line">    <span class="type">const</span> <span class="type">static</span> Long Mod = <span class="number">1000000000</span>;</span><br><span class="line">    <span class="keyword">mutable</span> std::vector&lt;Long&gt; val;</span><br><span class="line">    <span class="keyword">mutable</span> <span class="type">bool</span> nega = <span class="literal">false</span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">trim</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function">    </span>{</span><br><span class="line">        <span class="keyword">while</span> (val.<span class="built_in">size</span>() &amp;&amp; val.<span class="built_in">back</span>() == <span class="number">0</span>)</span><br><span class="line">            val.<span class="built_in">pop_back</span>();</span><br><span class="line">        <span class="keyword">if</span> (val.<span class="built_in">empty</span>())</span><br><span class="line">            nega = <span class="literal">false</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">size</span><span class="params">()</span> <span class="type">const</span> </span>{ <span class="keyword">return</span> val.<span class="built_in">size</span>(); }</span><br><span class="line">    Long &amp;<span class="keyword">operator</span>[](<span class="type">int</span> index) <span class="type">const</span> { <span class="keyword">return</span> val[index]; }</span><br><span class="line">    <span class="function">Long &amp;<span class="title">back</span><span class="params">()</span> <span class="type">const</span> </span>{ <span class="keyword">return</span> val.<span class="built_in">back</span>(); }</span><br><span class="line">    <span class="built_in">BigInt</span>(<span class="type">int</span> size, <span class="type">bool</span> nega) : <span class="built_in">val</span>(size), <span class="built_in">nega</span>(nega) {}</span><br><span class="line">    <span class="built_in">BigInt</span>(<span class="type">const</span> std::vector&lt;Long&gt; &amp;val, <span class="type">bool</span> nega) : <span class="built_in">val</span>(val), <span class="built_in">nega</span>(nega) {}</span><br><span class="line"></span><br><span class="line">    <span class="keyword">friend</span> std::ostream &amp;<span class="keyword">operator</span>&lt;&lt;(std::ostream &amp;os, <span class="type">const</span> BigInt &amp;n)</span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">if</span> (n.<span class="built_in">size</span>())</span><br><span class="line">        {</span><br><span class="line">            <span class="keyword">if</span> (n.nega)</span><br><span class="line">                <span class="built_in">putchar</span>(<span class="string">'-'</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = n.<span class="built_in">size</span>() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line">            {</span><br><span class="line">                <span class="keyword">if</span> (i == n.<span class="built_in">size</span>() - <span class="number">1</span>)</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">"%lld"</span>, n[i]);</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">"%0*lld"</span>, n.Exp, n[i]);</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">putchar</span>(<span class="string">'0'</span>);</span><br><span class="line">        <span class="keyword">return</span> os;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">friend</span> BigInt <span class="keyword">operator</span>+(<span class="type">const</span> BigInt &amp;lhs, <span class="type">const</span> BigInt &amp;rhs)</span><br><span class="line">    {</span><br><span class="line">        <span class="function">BigInt <span class="title">ret</span><span class="params">(lhs)</span></span>;</span><br><span class="line">        <span class="keyword">return</span> ret += rhs;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">friend</span> BigInt <span class="keyword">operator</span>-(<span class="type">const</span> BigInt &amp;lhs, <span class="type">const</span> BigInt &amp;rhs)</span><br><span class="line">    {</span><br><span class="line">        <span class="function">BigInt <span class="title">ret</span><span class="params">(lhs)</span></span>;</span><br><span class="line">        <span class="keyword">return</span> ret -= rhs;</span><br><span class="line">    }</span><br><span class="line">    <span class="built_in">BigInt</span>(Long x = <span class="number">0</span>)</span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">            x = -x, nega = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">while</span> (x &gt;= Mod)</span><br><span class="line">            val.<span class="built_in">push_back</span>(x % Mod), x /= Mod;</span><br><span class="line">        <span class="keyword">if</span> (x)</span><br><span class="line">            val.<span class="built_in">push_back</span>(x);</span><br><span class="line">    }</span><br><span class="line">    <span class="built_in">BigInt</span>(<span class="type">const</span> <span class="type">char</span> *s)</span><br><span class="line">    {</span><br><span class="line">        <span class="type">int</span> bound = <span class="number">0</span>, pos;</span><br><span class="line">        <span class="keyword">if</span> (s[<span class="number">0</span>] == <span class="string">'-'</span>)</span><br><span class="line">            nega = <span class="literal">true</span>, bound = <span class="number">1</span>;</span><br><span class="line">        Long cur = <span class="number">0</span>, pow = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (pos = <span class="built_in">strlen</span>(s) - <span class="number">1</span>; pos &gt;= Exp + bound - <span class="number">1</span>; pos -= Exp, val.<span class="built_in">push_back</span>(cur), cur = <span class="number">0</span>, pow = <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = pos; i &gt; pos - Exp; --i)</span><br><span class="line">                cur += (s[i] - <span class="string">'0'</span>) * pow, pow *= <span class="number">10</span>;</span><br><span class="line">        <span class="keyword">for</span> (cur = <span class="number">0</span>, pow = <span class="number">1</span>; pos &gt;= bound; --pos)</span><br><span class="line">            cur += (s[pos] - <span class="string">'0'</span>) * pow, pow *= <span class="number">10</span>;</span><br><span class="line">        <span class="keyword">if</span> (cur)</span><br><span class="line">            val.<span class="built_in">push_back</span>(cur);</span><br><span class="line">    }</span><br><span class="line">    BigInt &amp;<span class="keyword">operator</span>=(<span class="type">const</span> <span class="type">char</span> *s){</span><br><span class="line">        BigInt <span class="built_in">n</span>(s);</span><br><span class="line">        *<span class="keyword">this</span> = n;</span><br><span class="line">        <span class="keyword">return</span> n;</span><br><span class="line">    }</span><br><span class="line">    BigInt &amp;<span class="keyword">operator</span>=(<span class="type">const</span> Long x){</span><br><span class="line">        BigInt <span class="built_in">n</span>(x);</span><br><span class="line">        *<span class="keyword">this</span> = n;</span><br><span class="line">        <span class="keyword">return</span> n;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">friend</span> std::istream &amp;<span class="keyword">operator</span>&gt;&gt;(std::istream &amp;is, BigInt &amp;n){</span><br><span class="line">        string s;</span><br><span class="line">        is &gt;&gt; s;</span><br><span class="line">        n=(<span class="type">char</span>*)s.<span class="built_in">data</span>();</span><br><span class="line">        <span class="keyword">return</span> is;</span><br><span class="line">    }</span><br><span class="line">    BigInt &amp;<span class="keyword">operator</span>+=(<span class="type">const</span> BigInt &amp;rhs)</span><br><span class="line">    {</span><br><span class="line">        <span class="type">const</span> <span class="type">int</span> cap = std::<span class="built_in">max</span>(<span class="built_in">size</span>(), rhs.<span class="built_in">size</span>()) + <span class="number">1</span>;</span><br><span class="line">        val.<span class="built_in">resize</span>(cap);</span><br><span class="line">        <span class="type">int</span> carry = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; cap - <span class="number">1</span>; ++i)</span><br><span class="line">        {</span><br><span class="line">            val[i] = <span class="built_in">Value</span>(val[i], nega) + <span class="built_in">Value</span>(<span class="built_in">At</span>(rhs, i), rhs.nega) + carry, carry = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span> (val[i] &gt;= Mod)</span><br><span class="line">                val[i] -= Mod, carry = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (val[i] &lt; <span class="number">0</span>)</span><br><span class="line">                val[i] += Mod, carry = <span class="number">-1</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span> ((val.<span class="built_in">back</span>() = carry) == <span class="number">-1</span>) <span class="comment">//assert(val.back() == 1 or 0 or -1)</span></span><br><span class="line">        {</span><br><span class="line">            nega = <span class="literal">true</span>, val.<span class="built_in">pop_back</span>();</span><br><span class="line">            <span class="type">bool</span> tailZero = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; cap - <span class="number">1</span>; ++i)</span><br><span class="line">            {</span><br><span class="line">                <span class="keyword">if</span> (tailZero &amp;&amp; val[i])</span><br><span class="line">                    val[i] = Mod - val[i], tailZero = <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    val[i] = Mod - <span class="number">1</span> - val[i];</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="built_in">trim</span>();</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">friend</span> BigInt <span class="keyword">operator</span>-(<span class="type">const</span> BigInt &amp;rhs)</span><br><span class="line">    {</span><br><span class="line">        <span class="function">BigInt <span class="title">ret</span><span class="params">(rhs)</span></span>;</span><br><span class="line">        ret.nega ^= <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    }</span><br><span class="line">    BigInt &amp;<span class="keyword">operator</span>-=(<span class="type">const</span> BigInt &amp;rhs)</span><br><span class="line">    {</span><br><span class="line">        rhs.nega ^= <span class="number">1</span>;</span><br><span class="line">        *<span class="keyword">this</span> += rhs;</span><br><span class="line">        rhs.nega ^= <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">friend</span> BigInt <span class="keyword">operator</span>*(<span class="type">const</span> BigInt &amp;lhs, <span class="type">const</span> BigInt &amp;rhs)</span><br><span class="line">    {</span><br><span class="line">        <span class="type">int</span> len=<span class="number">1</span>;</span><br><span class="line">        BigInt ll=lhs,rr=rhs;</span><br><span class="line">        ll.nega = lhs.nega ^ rhs.nega;</span><br><span class="line">        <span class="keyword">while</span>(len&lt;<span class="number">2</span>*lhs.<span class="built_in">size</span>()||len&lt;<span class="number">2</span>*rhs.<span class="built_in">size</span>())len&lt;&lt;=<span class="number">1</span>;</span><br><span class="line">        ll.val.<span class="built_in">resize</span>(len),rr.val.<span class="built_in">resize</span>(len);</span><br><span class="line">        Complex x1[len],x2[len];</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;len;i++){</span><br><span class="line">            <span class="function">Complex <span class="title">nx</span><span class="params">(ll[i],<span class="number">0.0</span>)</span>,<span class="title">ny</span><span class="params">(rr[i],<span class="number">0.0</span>)</span></span>;</span><br><span class="line">            x1[i]=nx;</span><br><span class="line">            x2[i]=ny;</span><br><span class="line">        }</span><br><span class="line">        <span class="built_in">fft</span>(x1,len,<span class="number">1</span>);</span><br><span class="line">        <span class="built_in">fft</span>(x2,len,<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span> ; i &lt; len; i++)</span><br><span class="line">            x1[i] = x1[i] * x2[i];</span><br><span class="line">        <span class="built_in">fft</span>( x1 , len , <span class="number">-1</span> );</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span> ; i &lt; len; i++)</span><br><span class="line">            ll[i] = <span class="built_in">int</span>( x1[i].x + <span class="number">0.5</span> );</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span> ; i &lt; len; i++){</span><br><span class="line">            ll[i+<span class="number">1</span>]+=ll[i]/Mod;</span><br><span class="line">            ll[i]%=Mod;</span><br><span class="line">        }</span><br><span class="line">        ll.<span class="built_in">trim</span>();</span><br><span class="line">        <span class="keyword">return</span> ll;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">friend</span> BigInt <span class="keyword">operator</span>*(<span class="type">const</span> BigInt &amp;lhs, <span class="type">const</span> Long &amp;x){</span><br><span class="line">        BigInt ret=lhs;</span><br><span class="line">        <span class="type">bool</span> negat = ( x &lt; <span class="number">0</span> );</span><br><span class="line">        Long xx = (negat) ? -x : x;</span><br><span class="line">        ret.nega ^= negat;</span><br><span class="line">        ret.val.<span class="built_in">push_back</span>(<span class="number">0</span>);</span><br><span class="line">        ret.val.<span class="built_in">push_back</span>(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; ret.<span class="built_in">size</span>(); i++)</span><br><span class="line">            ret[i]*=xx;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; ret.<span class="built_in">size</span>(); i++){</span><br><span class="line">            ret[i+<span class="number">1</span>]+=ret[i]/Mod;</span><br><span class="line">            ret[i] %= Mod;</span><br><span class="line">        }</span><br><span class="line">        ret.<span class="built_in">trim</span>();</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    }</span><br><span class="line">    BigInt &amp;<span class="keyword">operator</span>*=(<span class="type">const</span> BigInt &amp;rhs) { <span class="keyword">return</span> *<span class="keyword">this</span> = *<span class="keyword">this</span> * rhs; }</span><br><span class="line">    BigInt &amp;<span class="keyword">operator</span>*=(<span class="type">const</span> Long &amp;x) { <span class="keyword">return</span> *<span class="keyword">this</span> = *<span class="keyword">this</span> * x; }</span><br><span class="line">    <span class="keyword">friend</span> BigInt <span class="keyword">operator</span>/(<span class="type">const</span> BigInt &amp;lhs, <span class="type">const</span> BigInt &amp;rhs)</span><br><span class="line">    {</span><br><span class="line">        <span class="type">static</span> std::vector&lt;BigInt&gt; powTwo{<span class="built_in">BigInt</span>(<span class="number">1</span>)};</span><br><span class="line">        <span class="type">static</span> std::vector&lt;BigInt&gt; estimate;</span><br><span class="line">        estimate.<span class="built_in">clear</span>();</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">absComp</span>(lhs, rhs) &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">BigInt</span>();</span><br><span class="line">        BigInt cur = rhs;</span><br><span class="line">        <span class="type">int</span> cmp;</span><br><span class="line">        <span class="keyword">while</span> ((cmp = <span class="built_in">absComp</span>(cur, lhs)) &lt;= <span class="number">0</span>)</span><br><span class="line">        {</span><br><span class="line">            estimate.<span class="built_in">push_back</span>(cur), cur += cur;</span><br><span class="line">            <span class="keyword">if</span> (estimate.<span class="built_in">size</span>() &gt;= powTwo.<span class="built_in">size</span>())</span><br><span class="line">                powTwo.<span class="built_in">push_back</span>(powTwo.<span class="built_in">back</span>() + powTwo.<span class="built_in">back</span>());</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span> (cmp == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">BigInt</span>(powTwo.<span class="built_in">back</span>().val, lhs.nega ^ rhs.nega);</span><br><span class="line">        BigInt ret = powTwo[estimate.<span class="built_in">size</span>() - <span class="number">1</span>];</span><br><span class="line">        cur = estimate[estimate.<span class="built_in">size</span>() - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = estimate.<span class="built_in">size</span>() - <span class="number">1</span>; i &gt;= <span class="number">0</span> &amp;&amp; cmp != <span class="number">0</span>; --i)</span><br><span class="line">            <span class="keyword">if</span> ((cmp = <span class="built_in">absComp</span>(cur + estimate[i], lhs)) &lt;= <span class="number">0</span>)</span><br><span class="line">                cur += estimate[i], ret += powTwo[i];</span><br><span class="line">        ret.nega = lhs.nega ^ rhs.nega;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">friend</span> BigInt <span class="keyword">operator</span>/(<span class="type">const</span> BigInt &amp;num,<span class="type">const</span> Long &amp;x){</span><br><span class="line">        <span class="type">bool</span> negat = ( x &lt; <span class="number">0</span> );</span><br><span class="line">        Long xx = (negat) ? -x : x;</span><br><span class="line">        BigInt ret;</span><br><span class="line">        Long k = <span class="number">0</span>;</span><br><span class="line">        ret.val.<span class="built_in">resize</span>( num.<span class="built_in">size</span>() );</span><br><span class="line">        ret.nega = (num.nega ^ negat);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = num.<span class="built_in">size</span>() - <span class="number">1</span> ;i &gt;= <span class="number">0</span>; i--){</span><br><span class="line">            ret[i] = ( k * Mod + num[i]) / xx;</span><br><span class="line">            k = ( k * Mod + num[i]) % xx;</span><br><span class="line">        }</span><br><span class="line">        ret.<span class="built_in">trim</span>();</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    }</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span>==(<span class="type">const</span> BigInt &amp;rhs) <span class="type">const</span></span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">return</span> nega == rhs.nega &amp;&amp; val == rhs.val;</span><br><span class="line">    }</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span>!=(<span class="type">const</span> BigInt &amp;rhs) <span class="type">const</span> { <span class="keyword">return</span> nega != rhs.nega || val != rhs.val; }</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span>&gt;=(<span class="type">const</span> BigInt &amp;rhs) <span class="type">const</span> { <span class="keyword">return</span> !(*<span class="keyword">this</span> &lt; rhs); }</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span>&gt;(<span class="type">const</span> BigInt &amp;rhs) <span class="type">const</span> { <span class="keyword">return</span> !(*<span class="keyword">this</span> &lt;= rhs); }</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span>&lt;=(<span class="type">const</span> BigInt &amp;rhs) <span class="type">const</span></span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">if</span> (nega &amp;&amp; !rhs.nega)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (!nega &amp;&amp; rhs.nega)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="type">int</span> cmp = <span class="built_in">absComp</span>(*<span class="keyword">this</span>, rhs);</span><br><span class="line">        <span class="keyword">return</span> nega ? cmp &gt;= <span class="number">0</span> : cmp &lt;= <span class="number">0</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> BigInt &amp;rhs) <span class="type">const</span></span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">if</span> (nega &amp;&amp; !rhs.nega)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (!nega &amp;&amp; rhs.nega)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">absComp</span>(*<span class="keyword">this</span>, rhs) &lt; <span class="number">0</span>) ^ nega;</span><br><span class="line">    }</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">swap</span><span class="params">(<span class="type">const</span> BigInt &amp;rhs)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function">    </span>{</span><br><span class="line">        std::<span class="built_in">swap</span>(val, rhs.val);</span><br><span class="line">        std::<span class="built_in">swap</span>(nega, rhs.nega);</span><br><span class="line">    }</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="function">BigInt <span class="title">biggcd</span><span class="params">(BigInt x,BigInt y)</span></span>{</span><br><span class="line">    <span class="type">int</span> xcnt2=<span class="number">0</span>, ycnt2=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(!(x.val[<span class="number">0</span>]&amp;<span class="number">1</span>)){xcnt2++; x=x/<span class="number">2</span>;}</span><br><span class="line">    <span class="keyword">while</span>(!(y.val[<span class="number">0</span>]&amp;<span class="number">1</span>)){ycnt2++; y=y/<span class="number">2</span>;}</span><br><span class="line">    <span class="type">int</span> z=<span class="built_in">MIN</span>(xcnt2,ycnt2);</span><br><span class="line">    <span class="keyword">while</span>(x!=y){</span><br><span class="line">        <span class="keyword">if</span>(x&lt;y){<span class="built_in">swap</span>(x,y);}</span><br><span class="line">        x=x-y;</span><br><span class="line">        <span class="keyword">while</span>(!(x.val[<span class="number">0</span>]&amp;<span class="number">1</span>)){x=x/<span class="number">2</span>;}</span><br><span class="line">    }</span><br><span class="line">    BigInt temp = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">while</span>(z--){x=x*temp;}</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">}</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">BigInt ba,bb;</span></span><br><span class="line"><span class="comment">int main(){</span></span><br><span class="line"><span class="comment">    cin&gt;&gt;ba&gt;&gt;bb;</span></span><br><span class="line"><span class="comment">    cout &lt;&lt; ba + bb &lt;&lt; '\n';//和</span></span><br><span class="line"><span class="comment">    cout &lt;&lt; ba - bb &lt;&lt; '\n';//差</span></span><br><span class="line"><span class="comment">    cout &lt;&lt; ba * bb &lt;&lt; '\n';//积</span></span><br><span class="line"><span class="comment">    BigInt d;</span></span><br><span class="line"><span class="comment">    cout &lt;&lt; (d = ba / bb) &lt;&lt; '\n';//商</span></span><br><span class="line"><span class="comment">    cout &lt;&lt; ba - d * bb &lt;&lt; '\n';//余</span></span><br><span class="line"><span class="comment">    return 0;</span></span><br><span class="line"><span class="comment">}*/</span></span><br><span class="line"></span><br><span class="line">BigInt a,b;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">    cin&gt;&gt;a&gt;&gt;b;</span><br><span class="line">    cout&lt;&lt;<span class="built_in">biggcd</span>(a,b);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>作为对比，给出原作者的代码：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//作者：小黑AWM+MashPlant</span></span><br><span class="line"><span class="comment">//注：可以直接把BigInt和一样用cin cout都行，就是高精乘为了速度才用了FFT降低了精度，有需要可以自行更改。</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">double</span> PI = <span class="built_in">acos</span>(<span class="number">-1.0</span>);</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Complex</span>{</span><br><span class="line">    <span class="type">double</span> x,y;</span><br><span class="line">    <span class="built_in">Complex</span>(<span class="type">double</span> _x = <span class="number">0.0</span>,<span class="type">double</span> _y = <span class="number">0.0</span>){</span><br><span class="line">        x = _x;</span><br><span class="line">        y = _y;</span><br><span class="line">    }</span><br><span class="line">    Complex <span class="keyword">operator</span>-(<span class="type">const</span> Complex &amp;b)<span class="type">const</span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Complex</span>(x - b.x,y - b.y);</span><br><span class="line">    }</span><br><span class="line">    Complex <span class="keyword">operator</span>+(<span class="type">const</span> Complex &amp;b)<span class="type">const</span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Complex</span>(x + b.x,y + b.y);</span><br><span class="line">    }</span><br><span class="line">    Complex <span class="keyword">operator</span>*(<span class="type">const</span> Complex &amp;b)<span class="type">const</span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Complex</span>(x*b.x - y*b.y,x*b.y + y*b.x);</span><br><span class="line">    }</span><br><span class="line">};</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(Complex y[],<span class="type">int</span> len)</span></span>{</span><br><span class="line">    <span class="type">int</span> i,j,k;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>,j = len/<span class="number">2</span>;i&lt;len<span class="number">-1</span>;i++){</span><br><span class="line">        <span class="keyword">if</span>(i &lt; j)    <span class="built_in">swap</span>(y[i],y[j]);</span><br><span class="line">        k = len/<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">while</span>(j &gt;= k){</span><br><span class="line">            j = j - k;</span><br><span class="line">            k = k/<span class="number">2</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span>(j &lt; k)    j+=k;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">fft</span><span class="params">(Complex y[],<span class="type">int</span> len,<span class="type">int</span> on)</span></span>{</span><br><span class="line">    <span class="built_in">change</span>(y,len);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> h = <span class="number">2</span>;h &lt;= len;h&lt;&lt;=<span class="number">1</span>){</span><br><span class="line">        <span class="function">Complex <span class="title">wn</span><span class="params">(cos(on*<span class="number">2</span>*PI/h),sin(on*<span class="number">2</span>*PI/h))</span></span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>;j &lt; len;j += h){</span><br><span class="line">            <span class="function">Complex <span class="title">w</span><span class="params">(<span class="number">1</span>,<span class="number">0</span>)</span></span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> k = j;k &lt; j + h/<span class="number">2</span>;k++){</span><br><span class="line">                Complex u = y[k];</span><br><span class="line">                Complex t = w*y[k + h/<span class="number">2</span>];</span><br><span class="line">                y[k] = u + t;</span><br><span class="line">                y[k + h/<span class="number">2</span>] = u - t;</span><br><span class="line">                w = w*wn;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">if</span>(on == <span class="number">-1</span>){</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i &lt; len;i++){</span><br><span class="line">            y[i].x /= len;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BigInt</span></span><br><span class="line">{</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> Value(x, nega) ((nega) ? -(x) : (x))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> At(vec, index) ((index) &lt; vec.size() ? vec[(index)] : 0)</span></span><br><span class="line">    <span class="function"><span class="type">static</span> <span class="type">int</span> <span class="title">absComp</span><span class="params">(<span class="type">const</span> BigInt &amp;lhs, <span class="type">const</span> BigInt &amp;rhs)</span></span></span><br><span class="line"><span class="function">    </span>{</span><br><span class="line">        <span class="keyword">if</span> (lhs.<span class="built_in">size</span>() != rhs.<span class="built_in">size</span>())</span><br><span class="line">            <span class="keyword">return</span> lhs.<span class="built_in">size</span>() &lt; rhs.<span class="built_in">size</span>() ? <span class="number">-1</span> : <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = lhs.<span class="built_in">size</span>() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line">            <span class="keyword">if</span> (lhs[i] != rhs[i])</span><br><span class="line">                <span class="keyword">return</span> lhs[i] &lt; rhs[i] ? <span class="number">-1</span> : <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">using</span> Long = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line">    <span class="type">const</span> <span class="type">static</span> <span class="type">int</span> Exp = <span class="number">9</span>;</span><br><span class="line">    <span class="type">const</span> <span class="type">static</span> Long Mod = <span class="number">1000000000</span>;</span><br><span class="line">    <span class="keyword">mutable</span> std::vector&lt;Long&gt; val;</span><br><span class="line">    <span class="keyword">mutable</span> <span class="type">bool</span> nega = <span class="literal">false</span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">trim</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function">    </span>{</span><br><span class="line">        <span class="keyword">while</span> (val.<span class="built_in">size</span>() &amp;&amp; val.<span class="built_in">back</span>() == <span class="number">0</span>)</span><br><span class="line">            val.<span class="built_in">pop_back</span>();</span><br><span class="line">        <span class="keyword">if</span> (val.<span class="built_in">empty</span>())</span><br><span class="line">            nega = <span class="literal">false</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">size</span><span class="params">()</span> <span class="type">const</span> </span>{ <span class="keyword">return</span> val.<span class="built_in">size</span>(); }</span><br><span class="line">    Long &amp;<span class="keyword">operator</span>[](<span class="type">int</span> index) <span class="type">const</span> { <span class="keyword">return</span> val[index]; }</span><br><span class="line">    <span class="function">Long &amp;<span class="title">back</span><span class="params">()</span> <span class="type">const</span> </span>{ <span class="keyword">return</span> val.<span class="built_in">back</span>(); }</span><br><span class="line">    <span class="built_in">BigInt</span>(<span class="type">int</span> size, <span class="type">bool</span> nega) : <span class="built_in">val</span>(size), <span class="built_in">nega</span>(nega) {}</span><br><span class="line">    <span class="built_in">BigInt</span>(<span class="type">const</span> std::vector&lt;Long&gt; &amp;val, <span class="type">bool</span> nega) : <span class="built_in">val</span>(val), <span class="built_in">nega</span>(nega) {}</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">friend</span> std::ostream &amp;<span class="keyword">operator</span>&lt;&lt;(std::ostream &amp;os, <span class="type">const</span> BigInt &amp;n)</span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">if</span> (n.<span class="built_in">size</span>())</span><br><span class="line">        {</span><br><span class="line">            <span class="keyword">if</span> (n.nega)</span><br><span class="line">                <span class="built_in">putchar</span>(<span class="string">'-'</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = n.<span class="built_in">size</span>() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line">            {</span><br><span class="line">                <span class="keyword">if</span> (i == n.<span class="built_in">size</span>() - <span class="number">1</span>)</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">"%lld"</span>, n[i]);</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">"%0*lld"</span>, n.Exp, n[i]);</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">putchar</span>(<span class="string">'0'</span>);</span><br><span class="line">        <span class="keyword">return</span> os;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">friend</span> BigInt <span class="keyword">operator</span>+(<span class="type">const</span> BigInt &amp;lhs, <span class="type">const</span> BigInt &amp;rhs)</span><br><span class="line">    {</span><br><span class="line">        <span class="function">BigInt <span class="title">ret</span><span class="params">(lhs)</span></span>;</span><br><span class="line">        <span class="keyword">return</span> ret += rhs;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">friend</span> BigInt <span class="keyword">operator</span>-(<span class="type">const</span> BigInt &amp;lhs, <span class="type">const</span> BigInt &amp;rhs)</span><br><span class="line">    {</span><br><span class="line">        <span class="function">BigInt <span class="title">ret</span><span class="params">(lhs)</span></span>;</span><br><span class="line">        <span class="keyword">return</span> ret -= rhs;</span><br><span class="line">    }</span><br><span class="line">    <span class="built_in">BigInt</span>(Long x = <span class="number">0</span>)</span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">            x = -x, nega = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">while</span> (x &gt;= Mod)</span><br><span class="line">            val.<span class="built_in">push_back</span>(x % Mod), x /= Mod;</span><br><span class="line">        <span class="keyword">if</span> (x)</span><br><span class="line">            val.<span class="built_in">push_back</span>(x);</span><br><span class="line">    }</span><br><span class="line">    <span class="built_in">BigInt</span>(<span class="type">const</span> <span class="type">char</span> *s)</span><br><span class="line">    {</span><br><span class="line">        <span class="type">int</span> bound = <span class="number">0</span>, pos;</span><br><span class="line">        <span class="keyword">if</span> (s[<span class="number">0</span>] == <span class="string">'-'</span>)</span><br><span class="line">            nega = <span class="literal">true</span>, bound = <span class="number">1</span>;</span><br><span class="line">        Long cur = <span class="number">0</span>, pow = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (pos = <span class="built_in">strlen</span>(s) - <span class="number">1</span>; pos &gt;= Exp + bound - <span class="number">1</span>; pos -= Exp, val.<span class="built_in">push_back</span>(cur), cur = <span class="number">0</span>, pow = <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = pos; i &gt; pos - Exp; --i)</span><br><span class="line">                cur += (s[i] - <span class="string">'0'</span>) * pow, pow *= <span class="number">10</span>;</span><br><span class="line">        <span class="keyword">for</span> (cur = <span class="number">0</span>, pow = <span class="number">1</span>; pos &gt;= bound; --pos)</span><br><span class="line">            cur += (s[pos] - <span class="string">'0'</span>) * pow, pow *= <span class="number">10</span>;</span><br><span class="line">        <span class="keyword">if</span> (cur)</span><br><span class="line">            val.<span class="built_in">push_back</span>(cur);</span><br><span class="line">    }</span><br><span class="line">    BigInt &amp;<span class="keyword">operator</span>=(<span class="type">const</span> <span class="type">char</span> *s){</span><br><span class="line">        BigInt <span class="built_in">n</span>(s);</span><br><span class="line">        *<span class="keyword">this</span> = n;</span><br><span class="line">        <span class="keyword">return</span> n;</span><br><span class="line">    }</span><br><span class="line">    BigInt &amp;<span class="keyword">operator</span>=(<span class="type">const</span> Long x){</span><br><span class="line">        BigInt <span class="built_in">n</span>(x);</span><br><span class="line">        *<span class="keyword">this</span> = n;</span><br><span class="line">        <span class="keyword">return</span> n;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">friend</span> std::istream &amp;<span class="keyword">operator</span>&gt;&gt;(std::istream &amp;is, BigInt &amp;n){</span><br><span class="line">        string s;</span><br><span class="line">        is &gt;&gt; s;</span><br><span class="line">        n=(<span class="type">char</span>*)s.<span class="built_in">data</span>();</span><br><span class="line">        <span class="keyword">return</span> is;</span><br><span class="line">    }</span><br><span class="line">    BigInt &amp;<span class="keyword">operator</span>+=(<span class="type">const</span> BigInt &amp;rhs)</span><br><span class="line">    {</span><br><span class="line">        <span class="type">const</span> <span class="type">int</span> cap = std::<span class="built_in">max</span>(<span class="built_in">size</span>(), rhs.<span class="built_in">size</span>()) + <span class="number">1</span>;</span><br><span class="line">        val.<span class="built_in">resize</span>(cap);</span><br><span class="line">        <span class="type">int</span> carry = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; cap - <span class="number">1</span>; ++i)</span><br><span class="line">        {</span><br><span class="line">            val[i] = <span class="built_in">Value</span>(val[i], nega) + <span class="built_in">Value</span>(<span class="built_in">At</span>(rhs, i), rhs.nega) + carry, carry = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span> (val[i] &gt;= Mod)</span><br><span class="line">                val[i] -= Mod, carry = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (val[i] &lt; <span class="number">0</span>)</span><br><span class="line">                val[i] += Mod, carry = <span class="number">-1</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span> ((val.<span class="built_in">back</span>() = carry) == <span class="number">-1</span>) <span class="comment">//assert(val.back() == 1 or 0 or -1)</span></span><br><span class="line">        {</span><br><span class="line">            nega = <span class="literal">true</span>, val.<span class="built_in">pop_back</span>();</span><br><span class="line">            <span class="type">bool</span> tailZero = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; cap - <span class="number">1</span>; ++i)</span><br><span class="line">            {</span><br><span class="line">                <span class="keyword">if</span> (tailZero &amp;&amp; val[i])</span><br><span class="line">                    val[i] = Mod - val[i], tailZero = <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    val[i] = Mod - <span class="number">1</span> - val[i];</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="built_in">trim</span>();</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">friend</span> BigInt <span class="keyword">operator</span>-(<span class="type">const</span> BigInt &amp;rhs)</span><br><span class="line">    {</span><br><span class="line">        <span class="function">BigInt <span class="title">ret</span><span class="params">(rhs)</span></span>;</span><br><span class="line">        ret.nega ^= <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    }</span><br><span class="line">    BigInt &amp;<span class="keyword">operator</span>-=(<span class="type">const</span> BigInt &amp;rhs)</span><br><span class="line">    {</span><br><span class="line">        rhs.nega ^= <span class="number">1</span>;</span><br><span class="line">        *<span class="keyword">this</span> += rhs;</span><br><span class="line">        rhs.nega ^= <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">friend</span> BigInt <span class="keyword">operator</span>*(<span class="type">const</span> BigInt &amp;lhs, <span class="type">const</span> BigInt &amp;rhs)</span><br><span class="line">    {</span><br><span class="line">        <span class="type">int</span> len=<span class="number">1</span>;</span><br><span class="line">        BigInt ll=lhs,rr=rhs;</span><br><span class="line">        ll.nega = lhs.nega ^ rhs.nega;</span><br><span class="line">        <span class="keyword">while</span>(len&lt;<span class="number">2</span>*lhs.<span class="built_in">size</span>()||len&lt;<span class="number">2</span>*rhs.<span class="built_in">size</span>())len&lt;&lt;=<span class="number">1</span>;</span><br><span class="line">        ll.val.<span class="built_in">resize</span>(len),rr.val.<span class="built_in">resize</span>(len);</span><br><span class="line">        Complex x1[len],x2[len];</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;len;i++){</span><br><span class="line">            <span class="function">Complex <span class="title">nx</span><span class="params">(ll[i],<span class="number">0.0</span>)</span>,<span class="title">ny</span><span class="params">(rr[i],<span class="number">0.0</span>)</span></span>;</span><br><span class="line">            x1[i]=nx;</span><br><span class="line">            x2[i]=ny;</span><br><span class="line">        }</span><br><span class="line">        <span class="built_in">fft</span>(x1,len,<span class="number">1</span>);</span><br><span class="line">        <span class="built_in">fft</span>(x2,len,<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span> ; i &lt; len; i++)</span><br><span class="line">            x1[i] = x1[i] * x2[i];</span><br><span class="line">        <span class="built_in">fft</span>( x1 , len , <span class="number">-1</span> );</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span> ; i &lt; len; i++)</span><br><span class="line">            ll[i] = <span class="built_in">int</span>( x1[i].x + <span class="number">0.5</span> );</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span> ; i &lt; len; i++){</span><br><span class="line">            ll[i+<span class="number">1</span>]+=ll[i]/Mod;</span><br><span class="line">            ll[i]%=Mod;</span><br><span class="line">        }</span><br><span class="line">        ll.<span class="built_in">trim</span>();</span><br><span class="line">        <span class="keyword">return</span> ll;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">friend</span> BigInt <span class="keyword">operator</span>*(<span class="type">const</span> BigInt &amp;lhs, <span class="type">const</span> Long &amp;x){</span><br><span class="line">        BigInt ret=lhs;</span><br><span class="line">        <span class="type">bool</span> negat = ( x &lt; <span class="number">0</span> );</span><br><span class="line">        Long xx = (negat) ? -x : x;</span><br><span class="line">        ret.nega ^= negat;</span><br><span class="line">        ret.val.<span class="built_in">push_back</span>(<span class="number">0</span>);</span><br><span class="line">        ret.val.<span class="built_in">push_back</span>(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; ret.<span class="built_in">size</span>(); i++)</span><br><span class="line">            ret[i]*=xx;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; ret.<span class="built_in">size</span>(); i++){</span><br><span class="line">            ret[i+<span class="number">1</span>]+=ret[i]/Mod;</span><br><span class="line">            ret[i] %= Mod;</span><br><span class="line">        }</span><br><span class="line">        ret.<span class="built_in">trim</span>();</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    }</span><br><span class="line">    BigInt &amp;<span class="keyword">operator</span>*=(<span class="type">const</span> BigInt &amp;rhs) { <span class="keyword">return</span> *<span class="keyword">this</span> = *<span class="keyword">this</span> * rhs; }</span><br><span class="line">    BigInt &amp;<span class="keyword">operator</span>*=(<span class="type">const</span> Long &amp;x) { <span class="keyword">return</span> *<span class="keyword">this</span> = *<span class="keyword">this</span> * x; }</span><br><span class="line">    <span class="keyword">friend</span> BigInt <span class="keyword">operator</span>/(<span class="type">const</span> BigInt &amp;lhs, <span class="type">const</span> BigInt &amp;rhs)</span><br><span class="line">    {</span><br><span class="line">        <span class="type">static</span> std::vector&lt;BigInt&gt; powTwo{<span class="built_in">BigInt</span>(<span class="number">1</span>)};</span><br><span class="line">        <span class="type">static</span> std::vector&lt;BigInt&gt; estimate;</span><br><span class="line">        estimate.<span class="built_in">clear</span>();</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">absComp</span>(lhs, rhs) &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">BigInt</span>();</span><br><span class="line">        BigInt cur = rhs;</span><br><span class="line">        <span class="type">int</span> cmp;</span><br><span class="line">        <span class="keyword">while</span> ((cmp = <span class="built_in">absComp</span>(cur, lhs)) &lt;= <span class="number">0</span>)</span><br><span class="line">        {</span><br><span class="line">            estimate.<span class="built_in">push_back</span>(cur), cur += cur;</span><br><span class="line">            <span class="keyword">if</span> (estimate.<span class="built_in">size</span>() &gt;= powTwo.<span class="built_in">size</span>())</span><br><span class="line">                powTwo.<span class="built_in">push_back</span>(powTwo.<span class="built_in">back</span>() + powTwo.<span class="built_in">back</span>());</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span> (cmp == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">BigInt</span>(powTwo.<span class="built_in">back</span>().val, lhs.nega ^ rhs.nega);</span><br><span class="line">        BigInt ret = powTwo[estimate.<span class="built_in">size</span>() - <span class="number">1</span>];</span><br><span class="line">        cur = estimate[estimate.<span class="built_in">size</span>() - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = estimate.<span class="built_in">size</span>() - <span class="number">1</span>; i &gt;= <span class="number">0</span> &amp;&amp; cmp != <span class="number">0</span>; --i)</span><br><span class="line">            <span class="keyword">if</span> ((cmp = <span class="built_in">absComp</span>(cur + estimate[i], lhs)) &lt;= <span class="number">0</span>)</span><br><span class="line">                cur += estimate[i], ret += powTwo[i];</span><br><span class="line">        ret.nega = lhs.nega ^ rhs.nega;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">friend</span> BigInt <span class="keyword">operator</span>/(<span class="type">const</span> BigInt &amp;num,<span class="type">const</span> Long &amp;x){</span><br><span class="line">        <span class="type">bool</span> negat = ( x &lt; <span class="number">0</span> );</span><br><span class="line">        Long xx = (negat) ? -x : x;</span><br><span class="line">        BigInt ret;</span><br><span class="line">        Long k = <span class="number">0</span>;</span><br><span class="line">        ret.val.<span class="built_in">resize</span>( num.<span class="built_in">size</span>() );</span><br><span class="line">        ret.nega = (num.nega ^ negat);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = num.<span class="built_in">size</span>() - <span class="number">1</span> ;i &gt;= <span class="number">0</span>; i--){</span><br><span class="line">            ret[i] = ( k * Mod + num[i]) / xx;</span><br><span class="line">            k = ( k * Mod + num[i]) % xx;</span><br><span class="line">        }</span><br><span class="line">        ret.<span class="built_in">trim</span>();</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    }</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span>==(<span class="type">const</span> BigInt &amp;rhs) <span class="type">const</span></span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">return</span> nega == rhs.nega &amp;&amp; val == rhs.val;</span><br><span class="line">    }</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span>!=(<span class="type">const</span> BigInt &amp;rhs) <span class="type">const</span> { <span class="keyword">return</span> nega != rhs.nega || val != rhs.val; }</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span>&gt;=(<span class="type">const</span> BigInt &amp;rhs) <span class="type">const</span> { <span class="keyword">return</span> !(*<span class="keyword">this</span> &lt; rhs); }</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span>&gt;(<span class="type">const</span> BigInt &amp;rhs) <span class="type">const</span> { <span class="keyword">return</span> !(*<span class="keyword">this</span> &lt;= rhs); }</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span>&lt;=(<span class="type">const</span> BigInt &amp;rhs) <span class="type">const</span></span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">if</span> (nega &amp;&amp; !rhs.nega)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (!nega &amp;&amp; rhs.nega)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="type">int</span> cmp = <span class="built_in">absComp</span>(*<span class="keyword">this</span>, rhs);</span><br><span class="line">        <span class="keyword">return</span> nega ? cmp &gt;= <span class="number">0</span> : cmp &lt;= <span class="number">0</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> BigInt &amp;rhs) <span class="type">const</span></span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">if</span> (nega &amp;&amp; !rhs.nega)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (!nega &amp;&amp; rhs.nega)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">absComp</span>(*<span class="keyword">this</span>, rhs) &lt; <span class="number">0</span>) ^ nega;</span><br><span class="line">    }</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">swap</span><span class="params">(<span class="type">const</span> BigInt &amp;rhs)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function">    </span>{</span><br><span class="line">        std::<span class="built_in">swap</span>(val, rhs.val);</span><br><span class="line">        std::<span class="built_in">swap</span>(nega, rhs.nega);</span><br><span class="line">    }</span><br><span class="line">};</span><br><span class="line">BigInt ba,bb;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">    cin&gt;&gt;ba&gt;&gt;bb;</span><br><span class="line">    cout &lt;&lt; ba + bb &lt;&lt; <span class="string">'\n'</span>;<span class="comment">//和</span></span><br><span class="line">    cout &lt;&lt; ba - bb &lt;&lt; <span class="string">'\n'</span>;<span class="comment">//差</span></span><br><span class="line">    cout &lt;&lt; ba * bb &lt;&lt; <span class="string">'\n'</span>;<span class="comment">//积</span></span><br><span class="line">    BigInt d;</span><br><span class="line">    cout &lt;&lt; (d = ba / bb) &lt;&lt; <span class="string">'\n'</span>;<span class="comment">//商</span></span><br><span class="line">    cout &lt;&lt; ba - d * bb &lt;&lt; <span class="string">'\n'</span>;<span class="comment">//余</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h2 id="二分图最大匹配"><a href="#二分图最大匹配" class="headerlink" title="二分图最大匹配"></a>二分图最大匹配</h2><p>题目链接：<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P3386">https://www.luogu.com.cn/problem/P3386</a></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxvertex=<span class="number">503</span>&lt;&lt;<span class="number">1</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxedge=<span class="number">5e4</span>+<span class="number">3</span>;</span><br><span class="line"><span class="type">int</span> tot,n,m,e,ans;</span><br><span class="line"><span class="type">int</span> head[maxvertex],match[maxvertex&gt;&gt;<span class="number">1</span>];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Edge</span>{<span class="type">int</span> v,next;}edge[maxedge];</span><br><span class="line"><span class="type">bool</span> vis[maxvertex&gt;&gt;<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>{</span><br><span class="line">    edge[++tot].v=y;</span><br><span class="line">    edge[tot].next=head[x];</span><br><span class="line">    head[x]=tot;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x)</span></span>{</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=head[x],y;i;i=edge[i].next){</span><br><span class="line">        <span class="keyword">if</span>(!vis[y=edge[i].v]){</span><br><span class="line">            vis[y]=<span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span>((!match[y]) || <span class="built_in">dfs</span>(match[y])){</span><br><span class="line">                match[y]=x;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;n,&amp;m,&amp;e);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=e;i++){</span><br><span class="line">        <span class="type">int</span> x,y; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</span><br><span class="line">        <span class="built_in">addedge</span>(x,y);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++){</span><br><span class="line">        <span class="built_in">memset</span>(vis,<span class="literal">false</span>,<span class="built_in">sizeof</span>(vis));</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">dfs</span>(i)){ans++;}</span><br><span class="line">    }</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h2 id="字典树-Trie"><a href="#字典树-Trie" class="headerlink" title="字典树 (Trie)"></a>字典树 (Trie)</h2><blockquote>
<p>本文章的 Trie 内容参考自 oi-wiki.org/string/trie</p>
</blockquote>
<p>结构体封装的模板：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">trie</span> {</span><br><span class="line">  <span class="type">int</span> nex[<span class="number">100000</span>][<span class="number">26</span>], cnt;</span><br><span class="line">  <span class="type">bool</span> exist[<span class="number">100000</span>];  <span class="comment">// 该结点结尾的字符串是否存在</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">char</span> *s, <span class="type">int</span> l)</span> </span>{  <span class="comment">// 插入字符串</span></span><br><span class="line">    <span class="type">int</span> p = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; l; i++) {</span><br><span class="line">      <span class="type">int</span> c = s[i] - <span class="string">'a'</span>;</span><br><span class="line">      <span class="keyword">if</span> (!nex[p][c]) nex[p][c] = ++cnt;  <span class="comment">// 如果没有，就添加结点</span></span><br><span class="line">      p = nex[p][c];</span><br><span class="line">    }</span><br><span class="line">    exist[p] = <span class="number">1</span>;</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="type">bool</span> <span class="title">find</span><span class="params">(<span class="type">char</span> *s, <span class="type">int</span> l)</span> </span>{  <span class="comment">// 查找字符串</span></span><br><span class="line">    <span class="type">int</span> p = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; l; i++) {</span><br><span class="line">      <span class="type">int</span> c = s[i] - <span class="string">'a'</span>;</span><br><span class="line">      <span class="keyword">if</span> (!nex[p][c]) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">      p = nex[p][c];</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> exist[p];</span><br><span class="line">  }</span><br><span class="line">};</span><br></pre></td></tr></table></figure>
<p>题目： <a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P2580">https://www.luogu.com.cn/problem/P2580</a></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">5e5</span>+<span class="number">3</span>;</span><br><span class="line"><span class="type">char</span> s[<span class="number">55</span>];</span><br><span class="line"><span class="type">int</span> n,m,nex[MAXN][<span class="number">26</span>],tag[MAXN],cnt=<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++){</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>,s+<span class="number">1</span>);</span><br><span class="line">        <span class="type">int</span> p = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;s[j];j++){</span><br><span class="line">            <span class="type">int</span> c = s[j]-<span class="string">'a'</span>;</span><br><span class="line">            <span class="keyword">if</span>(!nex[p][c])nex[p][c]=++cnt;</span><br><span class="line">            p=nex[p][c];</span><br><span class="line">        }</span><br><span class="line">        tag[p] = <span class="number">1</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;m);</span><br><span class="line">    <span class="keyword">while</span>(m--){</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>,s+<span class="number">1</span>);</span><br><span class="line">        <span class="type">int</span> p = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;s[j];j++){</span><br><span class="line">            <span class="type">int</span> c = s[j]-<span class="string">'a'</span>;</span><br><span class="line">            p=nex[p][c];</span><br><span class="line">            <span class="keyword">if</span>(!p)<span class="keyword">break</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span>(tag[p]==<span class="number">1</span>){</span><br><span class="line">            tag[p]=<span class="number">2</span>;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">"OK"</span>);</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(tag[p]==<span class="number">2</span>) <span class="built_in">puts</span>(<span class="string">"REPEAT"</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"WRONG"</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h2 id="01-Trie"><a href="#01-Trie" class="headerlink" title="01-Trie"></a>01-Trie</h2><p>题面： <a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P4551">https://www.luogu.com.cn/problem/P4551</a></p>
<p>注意：以下按数位权值从高到低建立<code>trie</code>。</p>
<p><img src="https://bu.dusays.com/2023/02/14/63eb825f31ee3.jpg" alt="9-5.jpg"></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAX(a,b) ((a)&gt;(b)?(a):(b))</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">1e5</span>+<span class="number">3</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxm = maxn<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Edge</span>{<span class="type">int</span> v,w,next;}edge[maxm&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="type">int</span> head[maxn],tot,dis[maxn];</span><br><span class="line"><span class="type">int</span> n,m,ans,cnt=<span class="number">1</span>,nex[maxn&lt;&lt;<span class="number">5</span>][<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> z)</span></span>{</span><br><span class="line">    edge[++tot].v=y;</span><br><span class="line">    edge[tot].w=z;</span><br><span class="line">    edge[tot].next=head[x];</span><br><span class="line">    head[x]=tot;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">int</span> x)</span></span>{</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">30</span>,p=<span class="number">1</span>;~i;i--){</span><br><span class="line">        <span class="type">int</span> c = ((x&gt;&gt;i)&amp;<span class="number">1</span>); <span class="comment">//二进制从（权值）高位向低位取</span></span><br><span class="line">        <span class="keyword">if</span>(!nex[p][c])nex[p][c]=++cnt;</span><br><span class="line">        p=nex[p][c];</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get</span><span class="params">(<span class="type">int</span> x)</span></span>{</span><br><span class="line">    <span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">30</span>,p=<span class="number">1</span>;~i;i--){</span><br><span class="line">        <span class="type">int</span> c = ((x&gt;&gt;i)&amp;<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span>(nex[p][c^<span class="number">1</span>]){  <span class="comment">//贪心</span></span><br><span class="line">            p=nex[p][c^<span class="number">1</span>];</span><br><span class="line">            res |= (<span class="number">1</span>&lt;&lt;i);  <span class="comment">//第i位（从低权位向高权位数）置1</span></span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">else</span> p=nex[p][c];</span><br><span class="line">    }</span><br><span class="line">    ans=<span class="built_in">MAX</span>(ans,res);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> fa)</span></span>{</span><br><span class="line">    <span class="built_in">insert</span>(dis[x]);</span><br><span class="line">    <span class="built_in">get</span>(dis[x]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=head[x];i;i=edge[i].next){</span><br><span class="line">        <span class="type">int</span> y=edge[i].v;</span><br><span class="line">        <span class="keyword">if</span>(y==fa)<span class="keyword">continue</span>;</span><br><span class="line">        dis[y]=dis[x]^edge[i].w;</span><br><span class="line">        <span class="built_in">dfs</span>(y,x);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;n;i++){</span><br><span class="line">        <span class="type">int</span> x,y,z;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;x,&amp;y,&amp;z);</span><br><span class="line">        <span class="built_in">addedge</span>(x,y,z);</span><br><span class="line">        <span class="built_in">addedge</span>(y,x,z);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h3 id="维护异或和"><a href="#维护异或和" class="headerlink" title="维护异或和"></a>维护异或和</h3><p>注意：以下按权值从低位到高位建立<code>trie</code>。</p>
<p>对于每一个节点，记录以下三个量：</p>
<ul>
<li><code>ch[o][0/1]</code> 指节点 o 的两个儿子，<code>ch[o][0]</code>指下一位是 0，同理<code>ch[o][1]</code>指下一位是 1。</li>
<li><code>w[o]</code>指节点 o 到其父亲节点这条边上数值的数量（权值）。每插入一个数字<code>x</code>，<code>x</code>二进制拆分后在 trie 上路径的权值都会<code>+1</code>。</li>
<li><code>xorv[o]</code>指以 o 为根的子树维护的异或和。</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">maintain</span><span class="params">(<span class="type">int</span> o)</span></span>{</span><br><span class="line">    w[o] = xorv[o] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(ch[o][<span class="number">0</span>]){</span><br><span class="line">        w[o] += w[ch[o][<span class="number">0</span>]];</span><br><span class="line">        xorv[o] ^= xorv[ch[o][<span class="number">0</span>]] &lt;&lt; <span class="number">1</span>; <span class="comment">//挪位置，末位补0，对应o到ch[o][0]这条边</span></span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">if</span>(ch[o][<span class="number">1</span>]){</span><br><span class="line">        w[o] += w[ch[o][<span class="number">1</span>]];</span><br><span class="line">        xorv[o] ^= (xorv[ch[o][<span class="number">1</span>]] &lt;&lt; <span class="number">1</span>) | (w[ch[o][<span class="number">1</span>]] &amp; <span class="number">1</span>); </span><br><span class="line">    } <span class="comment">//因为ch[o][1]是经过1从o下来的，所以这个“经过的1”的这一位的异或和就是w[ch[o][1]]的奇偶性</span></span><br><span class="line">    w[o] = w[o] &amp; <span class="number">1</span>; <span class="comment">//这句话删掉也可以？因为上文就只利用了他的奇偶性。</span></span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>插入和删除，只需要修改叶子节点的<code>w[]</code>即可，在回溯的过程中一路维护：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> trie {</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXH = <span class="number">21</span>;</span><br><span class="line"><span class="type">int</span> ch[_ * (MAXH + <span class="number">1</span>)][<span class="number">2</span>], w[_ * (MAXH + <span class="number">1</span>)], xorv[_ * (MAXH + <span class="number">1</span>)];</span><br><span class="line"><span class="type">int</span> tot = <span class="number">0</span>;  <span class="comment">// 这里的 _ 是一个 int 型</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">mknode</span><span class="params">()</span> </span>{</span><br><span class="line">  ++tot;</span><br><span class="line">  ch[tot][<span class="number">1</span>] = ch[tot][<span class="number">0</span>] = w[tot] = xorv[tot] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> tot;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">maintain</span><span class="params">(<span class="type">int</span> o)</span> </span>{</span><br><span class="line">  w[o] = xorv[o] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> (ch[o][<span class="number">0</span>]) {</span><br><span class="line">    w[o] += w[ch[o][<span class="number">0</span>]];</span><br><span class="line">    xorv[o] ^= xorv[ch[o][<span class="number">0</span>]] &lt;&lt; <span class="number">1</span>;</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">if</span> (ch[o][<span class="number">1</span>]) {</span><br><span class="line">    w[o] += w[ch[o][<span class="number">1</span>]];</span><br><span class="line">    xorv[o] ^= (xorv[ch[o][<span class="number">1</span>]] &lt;&lt; <span class="number">1</span>) | (w[ch[o][<span class="number">1</span>]] &amp; <span class="number">1</span>);</span><br><span class="line">  }</span><br><span class="line">  w[o] = w[o] &amp; <span class="number">1</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">int</span> &amp;o, <span class="type">int</span> x, <span class="type">int</span> dp)</span> </span>{ <span class="comment">//看懂过，没时间别再看</span></span><br><span class="line">  <span class="keyword">if</span> (!o) o = <span class="built_in">mknode</span>();</span><br><span class="line">  <span class="keyword">if</span> (dp &gt; MAXH) <span class="keyword">return</span> (<span class="type">void</span>)(w[o]++);</span><br><span class="line">  <span class="built_in">insert</span>(ch[o][x &amp; <span class="number">1</span>], x &gt;&gt; <span class="number">1</span>, dp + <span class="number">1</span>);</span><br><span class="line">  <span class="built_in">maintain</span>(o);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">erase</span><span class="params">(<span class="type">int</span> o, <span class="type">int</span> x, <span class="type">int</span> dp)</span> </span>{</span><br><span class="line">  <span class="keyword">if</span> (dp &gt; <span class="number">20</span>) <span class="keyword">return</span> (<span class="type">void</span>)(w[o]--);</span><br><span class="line">  <span class="built_in">erase</span>(ch[o][x &amp; <span class="number">1</span>], x &gt;&gt; <span class="number">1</span>, dp + <span class="number">1</span>);</span><br><span class="line">  <span class="built_in">maintain</span>(o);</span><br><span class="line">}</span><br><span class="line">}  <span class="comment">// namespace trie</span></span><br></pre></td></tr></table></figure>
<p>注意：这里的<code>MAXH</code>指 trie 的深度，也就是强制让每一个叶子节点到根的距离为<code>MAXH</code>。对于一些比较小的值，可能有时候不需要建立这么深（例如：如果插入数字<code>4</code>，分解成二进制后为<code>100</code>，从根开始插入<code>001</code>这三位即可），但是我们强制插入<code>MAXH</code>位。这样做的目的是为了便于全局<code>+1</code>时处理进位。例如：如果原数字是<code>3</code>（<code>11</code>），递增之后变成<code>4</code>（<code>100</code>），如果当初插入<code>3</code>时只插入了<code>2</code>位，那这里的进位就没了。</p>

</div> 

<script>
    window.onload = detectors();
</script>
    <div class="post-footer">
    <div class="h-line-primary"></div>
    <nav class="post-nav">
        <div class="prev-item">
           
                <div class="icon arrow-left"></div>
                <div class="post-link">
                    <a href="/2022/11/07/221107_weigjj/">Prev</a>
                </div>
            
        </div>
        <div class="next-item">
            
                <div class="icon arrow-right"></div>
                <div class="post-link">
                  <a href="/2022/09/12/220912_qiannian/">Next</a>  
                </div>  
            
        </div>
    </nav>
</div>

    
      <div class="post-comment">

     

     
    
    

</div>
     
  
</article>
        </div>
      </div>
      
      <div class="footer">
    <div class="flex-container">
        <div class="footer-text">
            
            
                ©2022 - 2024 By rainman | 
            
            
                Powered by <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> & <a target="_blank" rel="noopener" href="https://github.com/zoeingwingkei/frame/">Frame</a>
                
        </div>
    </div>
</div>

    </div>

    
    

  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="//cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-MML-AM_CHTML"></script>
</body>
</html>
